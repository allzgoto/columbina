<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shadow Fight — Cinematic</title>

  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body { width: 100%; height: 100%; background: #000; overflow: hidden; }

    .stage {
      position: relative;
      width: 100%;
      height: 100%;
      background: radial-gradient(circle at center, #0b0b0b 0%, #000 70%);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    /* Vídeo principal (fundo) */
    .bg {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      opacity: 0;
      transition: opacity 450ms ease;
      background: #000;
    }
    .bg.is-active { opacity: 1; }

    /* Camada inicial (portal central) */
    .intro {
      position: absolute;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 1;
      transition: opacity 450ms ease;
      z-index: 2;
    }
    .intro.is-hidden {
      opacity: 0;
      pointer-events: none;
    }

    /* Botão/portal */
    .portal {
      width: min(320px, 70vw);
      aspect-ratio: 1 / 1;
      border-radius: 50%;
      overflow: hidden;
      cursor: pointer;
      position: relative;

      /* atmosfera mínima */
      box-shadow:
        0 0 30px rgba(255,255,255,0.08),
        0 0 80px rgba(255,255,255,0.04);
      border: 1px solid rgba(255,255,255,0.12);
      transform: translateZ(0);
      transition: transform 220ms ease, box-shadow 220ms ease, border-color 220ms ease;
    }
    .portal:hover {
      transform: scale(1.02);
      border-color: rgba(255,255,255,0.22);
      box-shadow:
        0 0 45px rgba(255,255,255,0.12),
        0 0 110px rgba(255,255,255,0.06);
    }

    .portal video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }

    /* leve vinheta só pra não ficar "clean" */
    .vignette {
      position: absolute;
      inset: 0;
      pointer-events: none;
      z-index: 3;
      background: radial-gradient(circle at center, rgba(0,0,0,0) 40%, rgba(0,0,0,0.65) 100%);
    }

    /* Anti-seleção */
    .noselect { user-select: none; -webkit-user-select: none; }
  </style>
</head>

<body>
  <main class="stage noselect">
    <!-- Vídeo principal (começa invisível, entra depois) -->
    <video
      id="mainVideo"
      class="bg"
      src="https://files.catbox.moe/klaol5.webm"
      playsinline
      preload="auto"
    ></video>

    <!-- Intro com portal -->
    <section id="intro" class="intro">
      <div id="portal" class="portal" aria-label="Ativar portal" role="button" tabindex="0">
        <video
          id="portalVideo"
          src="https://files.catbox.moe/5ci6gd.mp4"
          playsinline
          preload="auto"
          muted
        ></video>
      </div>
    </section>

    <div class="vignette"></div>
  </main>

  <script>
    const intro = document.getElementById("intro");
    const portal = document.getElementById("portal");
    const portalVideo = document.getElementById("portalVideo");
    const mainVideo = document.getElementById("mainVideo");

    let started = false;

    // Garante que o portal fica parado no primeiro frame (não autoplay)
    // e que o browser carrega dados suficientes pra exibir o frame inicial.
    function holdFirstFrame() {
      // Alguns browsers precisam de um "seek" pra cravar no 0 exato.
      try { portalVideo.currentTime = 0; } catch (e) {}
      portalVideo.pause();
    }

    portalVideo.addEventListener("loadeddata", holdFirstFrame, { once: true });

    async function startSequence() {
      if (started) return;
      started = true;

      // Toca a animação do portal
      portalVideo.muted = true; // só pra garantir que não bloqueia play
      try {
        await portalVideo.play();
      } catch (err) {
        // Se o browser bloquear, desbloqueia com um "clique" já ocorreu,
        // então normalmente não cai aqui — mas fica seguro.
        console.warn("Play do portal falhou:", err);
      }
    }

    function goToMainVideo() {
      // Some com a intro
      intro.classList.add("is-hidden");

      // Mostra e toca o vídeo principal
      mainVideo.classList.add("is-active");
      mainVideo.muted = false;
      mainVideo.loop = true;

      mainVideo.play().catch(err => {
        console.warn("Play do vídeo principal falhou:", err);
      });

      // Tenta fullscreen (pode falhar dependendo do browser)
      const el = document.documentElement;
      if (el.requestFullscreen) el.requestFullscreen().catch(() => {});
    }

    // Quando a animação do portal acabar, entra no vídeo principal
    portalVideo.addEventListener("ended", () => {
      goToMainVideo();
    });

    // Clique no portal
    portal.addEventListener("click", startSequence);

    // Acessibilidade: Enter/Space no "botão"
    portal.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        startSequence();
      }
    });
  </script>
</body>
</html>
