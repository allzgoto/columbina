<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shadow Fight 2 — Entry</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600;800&family=Cormorant+Garamond:wght@500;600;700&family=IM+Fell+English:ital@0;1&display=swap" rel="stylesheet">

<style>
*{margin:0;padding:0;box-sizing:border-box}
html,body{width:100%;height:100%;overflow:hidden;background:#000}

:root{
  --ember: rgba(255,140,70,1);
  --goldA: #fff2de;
  --goldB: #d9a56a;
  --goldC: #a8642c;
}

/* ===== VIDEO ===== */
#mainVideo{
  position:fixed; inset:0;
  width:100%; height:100%;
  object-fit:cover;
  z-index:0;
  opacity:0;
  transition:opacity 900ms ease, filter 900ms ease;
  filter:contrast(1.05) saturate(0.95);
}
body.entered #mainVideo{
  opacity:1;
  filter:contrast(1.06) saturate(0.92) blur(3px) brightness(0.82);
}
body.scrollOpen #mainVideo{
  filter:contrast(1.06) saturate(0.92) blur(6px) brightness(0.62);
}
body.socialOpen #mainVideo{
  filter:contrast(1.06) saturate(0.92) blur(7px) brightness(0.52);
}
body.playlistsOpen #mainVideo{
  filter:contrast(1.06) saturate(0.92) blur(7px) brightness(0.52);
}
body.adminOpen #mainVideo{
  filter:contrast(1.06) saturate(0.92) blur(7px) brightness(0.52);
}
body.editOpen #mainVideo{
  filter:contrast(1.06) saturate(0.92) blur(7px) brightness(0.52);
}

/* ===== ENTRY ===== */
#entry{
  position:fixed; inset:0;
  z-index:10;
  cursor:pointer;
  background:#000;
}
.bgFill{
  position:absolute; inset:0;
  background:url("https://files.catbox.moe/5yp48z.png") center/cover no-repeat;
  filter:blur(28px) brightness(0.22) contrast(1.2);
  transform:scale(1.2);
  z-index:1;
}
#ashCanvas{
  position:absolute; inset:0;
  z-index:2;
  pointer-events:none;
}
.stage{
  position:absolute; inset:0;
  display:grid;
  place-items:center;
  z-index:5;
}
.frameWrap{
  width:min(1000px,88vw);
  aspect-ratio:16/9;
  position:relative;
  border-radius:16px;
  overflow:hidden;
  box-shadow:
    0 0 0 1px rgba(255,170,90,0.1),
    0 40px 140px rgba(0,0,0,0.95);
  transition:transform 450ms ease;
}
#entry:hover .frameWrap{ transform:scale(1.01); }
.frame{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit:cover;
  filter:contrast(1.12) brightness(0.82) saturate(0.9);
}
.softOverlay{
  position:absolute; inset:0;
  z-index:2;
  background:
    radial-gradient(circle at center, rgba(0,0,0,0.18), rgba(0,0,0,0.72)),
    linear-gradient(to bottom, rgba(0,0,0,0.28), transparent 40%, rgba(0,0,0,0.55));
  backdrop-filter: blur(2px);
}
#strike{
  opacity:0;
  z-index:3;
  mix-blend-mode:screen;
  transition:opacity 200ms ease;
}
body.strikeOn #strike{opacity:0.95}

/* ===== ENTER UI ===== */
.introUI{
  position:absolute; inset:0;
  display:grid;
  place-items:center;
  text-align:center;
  z-index:4;
  pointer-events:none;
}
.title{
  font-family: "Cinzel", serif;
  font-weight:800;
  font-size: clamp(26px, 3.2vw, 44px);
  letter-spacing:7px;
  text-transform:uppercase;

  background: linear-gradient(
    to bottom,
    var(--goldA) 0%,
    #f0cfa2 18%,
    var(--goldB) 45%,
    var(--goldC) 68%,
    #f6d5a8 100%
  );
  -webkit-background-clip:text;
  -webkit-text-fill-color:transparent;

  text-shadow:
    0 2px 0 #000,
    0 0 10px rgba(255,140,70,0.55),
    0 0 34px rgba(255,100,0,0.35);

  position:relative;
  animation:pulse 2.6s ease-in-out infinite;
}
.title::after{
  content:"";
  position:absolute;
  inset:-14px -42px;
  background:
    radial-gradient(circle at center,
      rgba(255,120,0,0.14),
      rgba(0,0,0,0.75));
  z-index:-2;
  filter:blur(18px);
  border-radius:60px;
  opacity:0.85;
}
.title::before{
  content:"";
  position:absolute;
  inset:-8px -58px;
  z-index:-1;
  background: linear-gradient(120deg,
    transparent 0%,
    rgba(255,255,255,0.10) 35%,
    rgba(255,255,255,0.22) 50%,
    rgba(255,255,255,0.10) 65%,
    transparent 100%);
  transform:translateX(-70%);
  filter:blur(8px);
  opacity:0.55;
  animation:shine 2.8s ease-in-out infinite;
}
@keyframes shine{
  0%,55%{ transform:translateX(-70%); opacity:0.0; }
  65%{ opacity:0.55; }
  100%{ transform:translateX(70%); opacity:0.0; }
}
.sub{
  margin-top:12px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:10px;
  font-size:10px;
  letter-spacing:4px;
  color:rgba(255,255,255,0.42);
  text-transform:uppercase;
  animation:blink 1.2s steps(2,end) infinite;
}
.kbdEnter{
  display:inline-flex;
  align-items:center;
  justify-content:center;
  padding:6px 10px;
  border-radius:10px;
  border:1px solid rgba(255,170,90,0.22);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,140,70,0.10), rgba(0,0,0,0.72));
  box-shadow:
    inset 0 0 14px rgba(255,140,70,0.08),
    0 10px 40px rgba(0,0,0,0.55);
  color:rgba(255,220,190,0.80);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:11px;
  letter-spacing:1px;
}
.kbdEnter svg{ width:14px;height:14px; margin-left:7px; opacity:0.9; }

@keyframes pulse{ 0%,100%{transform:translateY(0);opacity:.88} 50%{transform:translateY(-3px);opacity:1} }
@keyframes blink{ 0%,49%{opacity:.22} 50%,100%{opacity:.62} }

body.strikeOn .introUI{ opacity:0; transition:opacity 300ms ease; }

body.entered #entry{
  opacity:0;
  pointer-events:none;
  transition:opacity 900ms ease;
}

/* ===== VOLUME (top-left) ===== */
#grimoire{ position:fixed; left:14px; top:14px; z-index:60; user-select:none; }
.grimoireBtn{
  width:44px; height:44px;
  border-radius:12px;
  border:1px solid rgba(255,170,90,0.18);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,140,70,0.16), rgba(0,0,0,0.78)),
    linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(0,0,0,0.55));
  box-shadow:
    0 14px 44px rgba(0,0,0,0.75),
    0 0 22px rgba(255,140,70,0.14),
    inset 0 0 14px rgba(255,140,70,0.10);
  display:grid;
  place-items:center;
  cursor:pointer;
  transition:transform .2s ease;
}
.grimoireBtn:hover{ transform:scale(1.05); }
.grimoireIcon{ width:21px; height:21px; }
.grimoireIcon svg{ width:100%; height:100%; display:block; }
.panel{
  position:absolute;
  left:0;
  top:54px;
  width:200px;
  padding:10px;
  border-radius:12px;
  border:1px solid rgba(255,170,90,0.18);
  background:
    radial-gradient(circle at 20% 20%, rgba(255,140,70,0.10), rgba(0,0,0,0.86)),
    linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(0,0,0,0.55));
  box-shadow:
    0 26px 110px rgba(0,0,0,0.86),
    inset 0 0 22px rgba(255,140,70,0.07);
  transform-origin: 0% 0%;
  transform: scale(0.92) translateY(8px);
  opacity:0;
  pointer-events:none;
  transition:opacity 180ms ease, transform 220ms ease;
}
#grimoire.open .panel{ opacity:1; transform: scale(1) translateY(0); pointer-events:auto; }
.row{ display:flex; align-items:center; gap:10px; }
.volValue{
  min-width:44px;
  text-align:right;
  font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
  color:rgba(255,255,255,0.55);
}
#vol{
  -webkit-appearance:none;
  appearance:none;
  width:100%;
  height:10px;
  border-radius:99px;
  outline:none;
  background:
    linear-gradient(to right, rgba(255,140,70,0.9) var(--p,8%), rgba(255,255,255,0.10) var(--p,8%));
  border:1px solid rgba(255,170,90,0.16);
  box-shadow: inset 0 0 18px rgba(0,0,0,0.65);
}
#vol::-webkit-slider-thumb{
  -webkit-appearance:none;
  appearance:none;
  width:16px; height:16px;
  border-radius:50%;
  background: radial-gradient(circle at 30% 30%, #fff2de, #d9a56a 55%, #8a4a1f);
  border:1px solid rgba(0,0,0,0.55);
  box-shadow: 0 0 16px rgba(255,140,70,0.30);
  cursor:pointer;
}
#vol::-moz-range-thumb{
  width:16px; height:16px;
  border-radius:50%;
  background: radial-gradient(circle at 30% 30%, #fff2de, #d9a56a 55%, #8a4a1f);
  border:1px solid rgba(0,0,0,0.55);
  box-shadow: 0 0 16px rgba(255,140,70,0.30);
  cursor:pointer;
}

/* ===== FULLSCREEN (abaixo do volume) ===== */
#fsWrap{
  position:fixed;
  left:14px;
  top:68px;
  z-index:60;
  user-select:none;
  transition: transform 220ms ease;
}
#grimoire.open ~ #fsWrap{ transform: translateY(70px); }
.fsBtn{
  width:44px;height:44px;
  border-radius:12px;
  border:1px solid rgba(255,170,90,0.18);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,140,70,0.12), rgba(0,0,0,0.80)),
    linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(0,0,0,0.55));
  box-shadow:
    0 14px 44px rgba(0,0,0,0.75),
    0 0 22px rgba(255,140,70,0.12);
  cursor:pointer;
  display:grid;
  place-items:center;
  transition:transform .2s ease, opacity .2s ease;
}
.fsBtn:hover{ transform:scale(1.05); }
.fsBtn svg{ width:22px;height:22px; opacity:.9; }

/* ===== BOTÃO DO PERGAMINHO (top-center) ===== */
#scrollBtn{
  position:fixed;
  left:50%;
  top:14px;
  transform:translateX(-50%);
  z-index:60;
  width:44px;height:44px;
  border-radius:12px;
  border:1px solid rgba(255,170,90,0.18);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,140,70,0.12), rgba(0,0,0,0.80)),
    linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(0,0,0,0.55));
  box-shadow:
    0 14px 44px rgba(0,0,0,0.75),
    0 0 22px rgba(255,140,70,0.12);
  cursor:pointer;
  display:grid;
  place-items:center;
  transition:transform .2s ease, opacity .2s ease;
  opacity:0;
  pointer-events:none;
}
body.entered #scrollBtn{ opacity:1; pointer-events:auto; }
#scrollBtn:hover{ transform:translateX(-50%) scale(1.05); }
#scrollBtn svg{ width:22px;height:22px; opacity:.9; }

/* ===== BOTÃO ADMIN (ao lado do pergaminho) ===== */
#adminBtn{
  position:fixed;
  left:calc(50% + 58px);
  top:14px;
  transform:translateX(-50%);
  z-index:60;
  width:44px;height:44px;
  border-radius:12px;
  border:1px solid rgba(255,170,90,0.18);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,140,70,0.12), rgba(0,0,0,0.80)),
    linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(0,0,0,0.55));
  box-shadow:
    0 14px 44px rgba(0,0,0,0.75),
    0 0 22px rgba(255,140,70,0.12);
  cursor:pointer;
  display:grid;
  place-items:center;
  transition:transform .2s ease, opacity .2s ease;
  opacity:0;
  pointer-events:none;
}
body.entered #adminBtn{ opacity:1; pointer-events:auto; }
#adminBtn:hover{ transform:translateX(-50%) scale(1.05); }
#adminBtn svg{ width:22px;height:22px; opacity:.9; }

/* ===== MENU (top-right) ===== */
#menuWrap{
  position:fixed;
  right:14px;
  top:14px;
  z-index:70;
  user-select:none;
}
.menuBtn{
  width:44px;height:44px;
  border-radius:12px;
  border:1px solid rgba(255,170,90,0.18);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,140,70,0.12), rgba(0,0,0,0.80)),
    linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(0,0,0,0.55));
  box-shadow:
    0 14px 44px rgba(0,0,0,0.75),
    0 0 22px rgba(255,140,70,0.12);
  cursor:pointer;
  display:grid;
  place-items:center;
  transition:transform .2s ease, opacity .2s ease, filter .2s ease;
  opacity:0;
  pointer-events:none;
}
body.entered .menuBtn{ opacity:1; pointer-events:auto; }
.menuBtn:hover{ transform:scale(1.05); }

/* ✅ ANIMAÇÃO CHAMATIVA SÓ NO MENU (até o primeiro clique) */
@keyframes menuPing{
  0%,100%{
    transform:scale(1);
    filter:brightness(1);
    box-shadow:
      0 14px 44px rgba(0,0,0,0.75),
      0 0 14px rgba(255,140,70,0.14);
  }
  50%{
    transform:scale(1.06);
    filter:brightness(1.08);
    box-shadow:
      0 14px 44px rgba(0,0,0,0.75),
      0 0 28px rgba(255,140,70,0.30);
  }
}
body.entered:not(.menuSeen) .menuBtn{
  animation:menuPing 2.2s ease-in-out infinite;
}
body.menuSeen .menuBtn{ animation:none; }

.menuBtn svg{ width:22px;height:22px; opacity:.9; }

.menuDrop{
  position:absolute;
  right:0;
  top:54px;
  width:220px;
  padding:10px;
  border-radius:14px;
  border:1px solid rgba(255,170,90,0.16);
  background:
    radial-gradient(circle at 20% 20%, rgba(255,140,70,0.08), rgba(0,0,0,0.92)),
    linear-gradient(to bottom, rgba(255,255,255,0.05), rgba(0,0,0,0.60));
  box-shadow:
    0 28px 120px rgba(0,0,0,0.90),
    inset 0 0 22px rgba(255,140,70,0.06);
  opacity:0;
  transform: translateY(10px) scale(0.96);
  pointer-events:none;
  transition: opacity 160ms ease, transform 200ms ease;
}
#menuWrap.open .menuDrop{
  opacity:1;
  transform: translateY(0px) scale(1);
  pointer-events:auto;
}
.menuItem{
  width:100%;
  border:none;
  cursor:pointer;
  text-align:left;
  padding:11px 10px;
  border-radius:12px;
  background:rgba(255,255,255,0.04);
  color:rgba(255,255,255,0.80);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing:1px;
  font-size:12px;
  text-transform:uppercase;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:10px;
  transition: transform .16s ease, background .16s ease;
}
.menuItem:hover{ transform: translateX(-2px); background:rgba(255,255,255,0.07); }
.menuItem .tag{ font-size:10px; letter-spacing:1px; opacity:.55; }

/* ===== OVERLAY BASE ===== */
@keyframes dimIn{ from{opacity:0} to{opacity:1} }

/* ===== OVERLAY DO PERGAMINHO ===== */
#scrollOverlay{
  position:fixed; inset:0;
  z-index:80;
  display:none;
}
body.scrollOpen #scrollOverlay{ display:block; }
#scrollOverlay .dim{
  position:absolute; inset:0;
  background:rgba(0,0,0,0.55);
}

/* ===== SOCIAL OVERLAY ===== */
#socialOverlay{
  position:fixed; inset:0;
  z-index:90;
  display:none;
}
body.socialOpen #socialOverlay{ display:block; }
#socialOverlay .dim{
  position:absolute; inset:0;
  background:rgba(0,0,0,0.80);
  backdrop-filter: blur(2px);
  animation:dimIn 240ms ease both;
}

/* ===== EDIT/HUB OVERLAY (AUTO) ===== */
#editOverlay{
  position:fixed; inset:0;
  z-index:92;
  display:none;
}
body.editOpen #editOverlay{ display:block; }
#editOverlay .dim{
  position:absolute; inset:0;
  background:rgba(0,0,0,0.84);
  backdrop-filter: blur(3px);
  animation:dimIn 240ms ease both;
}
.hubShell{
  position:absolute;
  left:50%; top:50%;
  transform:translate(-50%,-50%) scale(.96);
  width:min(980px, 94vw);
  height:min(620px, 84vh);
  border-radius:22px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(12,12,14,0.80);
  box-shadow: 0 44px 180px rgba(0,0,0,0.88);
  backdrop-filter: blur(18px);
  overflow:hidden;
  opacity:0;
  animation:hubIn 320ms cubic-bezier(.12,.92,.12,1) both;
}
@keyframes hubIn{
  from{opacity:0; transform:translate(-50%,-50%) scale(.92); filter:blur(10px);}
  to{opacity:1; transform:translate(-50%,-50%) scale(1); filter:blur(0);}
}
.hubTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:18px 18px 12px;
  border-bottom:1px solid rgba(255,255,255,0.08);
}
.hubTitle{
  display:flex; flex-direction:column; gap:6px;
}
.hubTitle b{
  color:rgba(255,255,255,0.92);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-size:18px;
}
.hubTitle span{
  color:rgba(255,255,255,0.55);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
}
.hubClose{
  border:none;
  cursor:pointer;
  padding:8px 12px;
  border-radius:999px;
  background: rgba(255,255,255,0.06);
  color:rgba(255,255,255,0.78);
  border:1px solid rgba(255,255,255,0.10);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}
.hubClose:hover{ background: rgba(255,255,255,0.09); }

.hubBody{
  height:calc(100% - 62px);
  display:grid;
  grid-template-columns: 1fr 340px;
  gap:14px;
  padding:14px;
}
.hubMain{
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.26);
  overflow:hidden;
  position:relative;
}
.hubMain::before{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(circle at 30% 20%, rgba(255,140,70,0.12), transparent 55%),
    radial-gradient(circle at 70% 80%, rgba(255,255,255,0.06), transparent 60%);
  pointer-events:none;
}
.hubMainInner{
  position:absolute; inset:0;
  padding:18px;
  display:flex;
  flex-direction:column;
  gap:12px;
  z-index:2;
}
.hubBig{
  flex:1;
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
  overflow:hidden;
  position:relative;
}
.hubBig .hint{
  position:absolute; left:16px; bottom:16px;
  color:rgba(255,255,255,0.68);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
}
.hubBig video{
  width:100%; height:100%;
  object-fit:cover;
  filter:contrast(1.02) saturate(0.92) brightness(0.92);
  opacity:0.92;
}
.hubCards{
  display:grid;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap:10px;
}
.hubCard{
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
  padding:12px;
}
.hubCard .k{
  color:rgba(255,255,255,0.55);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:11px;
  letter-spacing:1px;
  text-transform:uppercase;
}
.hubCard .v{
  margin-top:8px;
  color:rgba(255,255,255,0.92);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-size:16px;
  font-weight:800;
}

.hubSide{
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
  box-shadow: inset 0 0 22px rgba(0,0,0,0.45);
  padding:14px;
  overflow:auto;
}
.hubSideTitle{
  color:rgba(255,255,255,0.70);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing:2px;
  font-size:12px;
  text-transform:uppercase;
  margin-bottom:10px;
}
.hubSideText{
  color:rgba(255,255,255,0.70);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:650;
  line-height:1.45;
  font-size:13px;
}
.hubPills{
  display:flex;
  gap:8px;
  flex-wrap:wrap;
  margin-top:12px;
}
.hubPill{
  padding:7px 10px;
  border-radius:999px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.22);
  color:rgba(255,255,255,0.72);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:11px;
  letter-spacing:1px;
  text-transform:uppercase;
}

@media (max-width: 860px){
  .hubBody{ grid-template-columns: 1fr; }
  .hubCards{ grid-template-columns: 1fr; }
}

/* ===== SOCIAL CARD ===== */
.smCard{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%) scale(.94);
  width:min(520px, 92vw);
  border-radius:22px;
  background: rgba(18,18,20,0.86);
  border:1px solid rgba(255,255,255,0.10);
  box-shadow: 0 40px 180px rgba(0,0,0,0.84);
  backdrop-filter: blur(16px);
  overflow:hidden;
  opacity:0;
  animation:smIn 320ms cubic-bezier(.12,.92,.12,1) both;
}
@keyframes smIn{
  from{ opacity:0; transform:translate(-50%,-50%) scale(.92); filter:blur(10px); }
  to{ opacity:1; transform:translate(-50%,-50%) scale(1); filter:blur(0); }
}
.smCard::after{
  content:"";
  position:absolute;
  inset:-70%;
  background: linear-gradient(120deg,
    transparent 0%,
    rgba(255,255,255,0.08) 40%,
    rgba(255,255,255,0.16) 50%,
    rgba(255,255,255,0.08) 60%,
    transparent 100%);
  transform:translateX(-45%) rotate(12deg);
  opacity:0;
  pointer-events:none;
  animation:smShine 1.1s ease-in-out 120ms both;
}
@keyframes smShine{
  0%{ opacity:0; transform:translateX(-45%) rotate(12deg); }
  25%{ opacity:.9; }
  100%{ opacity:0; transform:translateX(45%) rotate(12deg); }
}
.smHead{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:18px 18px 12px;
}
.smTitle{
  color:rgba(255,255,255,0.70);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing:2px;
  font-size:12px;
  text-transform:uppercase;
}
.smClose{
  border:none;
  cursor:pointer;
  padding:8px 12px;
  border-radius:999px;
  background: rgba(255,255,255,0.06);
  color:rgba(255,255,255,0.78);
  border:1px solid rgba(255,255,255,0.10);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}
.smClose:hover{ background: rgba(255,255,255,0.09); }
.smBody{
  padding:6px 18px 18px;
  display:flex;
  flex-direction:column;
  gap:14px;
}
.smProfile{
  display:flex;
  flex-direction:column;
  align-items:center;
  text-align:center;
  gap:10px;
}
.smAvatar{
  width:86px;height:86px;
  border-radius:50%;
  border:1px solid rgba(255,255,255,0.12);
  box-shadow: 0 16px 70px rgba(0,0,0,0.72);
  overflow:hidden;
  background: rgba(255,255,255,0.06);
}
.smAvatar img{ width:100%;height:100%; object-fit:cover; display:block; }
.smName{
  font-size:38px;
  letter-spacing:1px;
  color:rgba(255,255,255,0.92);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:800;
}
.smBio{
  color:rgba(255,255,255,0.70);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:600;
  font-size:14px;
}
.smLoc{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:7px 12px;
  border-radius:999px;
  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
  color:rgba(255,255,255,0.75);
  font-size:12px;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}
.smLoc svg{ width:14px;height:14px; opacity:.9; }
.smIcons{
  display:flex;
  justify-content:center;
  gap:10px;
  margin-top:6px;
  flex-wrap:wrap;
}
.smIconBtn{
  width:46px;height:46px;
  border-radius:14px;
  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
  cursor:pointer;
  display:grid;
  place-items:center;
  transition: transform .15s ease, filter .15s ease, background .15s ease;
  position:relative;
  overflow:hidden;
  text-decoration:none;
}
.smIconBtn::after{
  content:"";
  position:absolute; inset:-80%;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.18), transparent 55%);
  opacity:0;
  transition:opacity .18s ease;
}
.smIconBtn:hover{
  transform: translateY(-1px);
  background: rgba(255,255,255,0.08);
  filter: brightness(1.06);
}
.smIconBtn:hover::after{ opacity:1; }
.smIconBtn:active{ transform: translateY(0px) scale(0.98); }
.smIconBtn svg{ width:20px;height:20px; opacity:.9; }

.smSection{
  border-radius:18px;
  padding:14px;
  background: rgba(255,255,255,0.05);
  border:1px solid rgba(255,255,255,0.10);
  box-shadow: inset 0 0 22px rgba(0,0,0,0.35);
}
.smSectionTitle{
  display:flex;
  align-items:center;
  justify-content:space-between;
  color:rgba(255,255,255,0.65);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing:2px;
  font-size:12px;
  text-transform:uppercase;
  margin-bottom:10px;
}
.smStatusPill{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding:6px 10px;
  border-radius:999px;
  background: rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
  color:rgba(255,255,255,0.78);
  font-size:12px;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}
.smDot{ width:10px;height:10px; border-radius:50%; background:#777; }
.smStatusPill[data-status="online"] .smDot{ background:#3bd671; }
.smStatusPill[data-status="idle"] .smDot{ background:#f2c94c; }
.smStatusPill[data-status="dnd"] .smDot{ background:#ff5b5b; }
.smStatusPill[data-status="offline"] .smDot{ background:#777; }

.smRow{ display:flex; align-items:center; gap:12px; }
.smDiscIcon{
  width:44px; height:44px;
  border-radius:14px;
  overflow:hidden;
  background:rgba(255,255,255,0.06);
  border:1px solid rgba(255,255,255,0.10);
  box-shadow: inset 0 0 18px rgba(0,0,0,0.55);
  display:grid;
  place-items:center;
  flex:0 0 auto;
}
#dAvatar{ width:100%; height:100%; display:none; object-fit:cover; border-radius:14px; }
.smDiscText{ display:flex; flex-direction:column; gap:2px; }
.smDiscName{
  color:rgba(255,255,255,0.92);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:800;
  font-size:14px;
}
.smDiscSub{
  color:rgba(255,255,255,0.62);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:600;
  font-size:12px;
}
.smFoot{
  margin-top:8px;
  text-align:center;
  color:rgba(255,255,255,0.45);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing:1px;
  font-size:11px;
}

/* ===== PERGAMINHO ===== */
.scroll{
  position:absolute;
  left:50%;
  top:50%;
  transform:translate(-50%,-50%) scale(.92);
  width:min(860px, 92vw);
  height:min(560px, 80vh);
  opacity:0;
  transition:opacity 220ms ease, transform 320ms cubic-bezier(.12,.92,.12,1);
  pointer-events:none;
}
body.scrollOpen .scroll{
  opacity:1;
  transform:translate(-50%,-50%) scale(1);
  pointer-events:auto;
}
.scrollPaper{
  position:absolute; inset:0;
  border-radius:18px;
  background:
    radial-gradient(circle at 10% 10%, rgba(90,35,10,0.40), transparent 42%),
    radial-gradient(circle at 92% 14%, rgba(80,28,8,0.38), transparent 46%),
    radial-gradient(circle at 18% 92%, rgba(80,28,8,0.34), transparent 48%),
    radial-gradient(circle at 90% 90%, rgba(80,28,8,0.36), transparent 50%),
    radial-gradient(circle at 28% 38%, rgba(0,0,0,0.08), transparent 38%),
    radial-gradient(circle at 70% 62%, rgba(0,0,0,0.07), transparent 42%),
    radial-gradient(circle at 55% 28%, rgba(0,0,0,0.06), transparent 44%),
    repeating-linear-gradient(12deg,
      rgba(0,0,0,0.03) 0px,
      rgba(0,0,0,0.03) 2px,
      rgba(255,255,255,0.02) 3px,
      rgba(255,255,255,0.02) 5px),
    linear-gradient(0deg, #cdb081, #eedcb6 22%, #e6cc9f 58%, #c7a572);
  box-shadow:
    0 40px 160px rgba(0,0,0,0.85),
    inset 0 0 0 1px rgba(0,0,0,0.18),
    inset 0 0 90px rgba(95,45,10,0.22);
  filter:contrast(1.06) saturate(0.92);
  overflow:hidden;
}
.scrollPaper::after{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(circle at center, rgba(255,255,255,0.08), transparent 55%),
    radial-gradient(circle at center, transparent 40%, rgba(0,0,0,0.20) 100%);
  pointer-events:none;
  mix-blend-mode:multiply;
  opacity:.95;
}
.scrollMask{
  position:absolute; inset:0;
  clip-path: polygon(
    2% 5%, 6% 2%, 12% 4%, 20% 2%, 28% 4%, 36% 2%, 44% 4%, 52% 2%, 60% 4%, 68% 2%, 76% 4%, 84% 2%, 92% 4%, 98% 8%,
    97% 18%, 99% 26%, 97% 34%, 99% 42%, 97% 50%, 99% 58%, 97% 66%, 99% 74%, 97% 82%, 98% 92%,
    92% 96%, 86% 98%, 78% 96%, 70% 98%, 62% 96%, 54% 98%, 46% 96%, 38% 98%, 30% 96%, 22% 98%, 14% 96%, 8% 98%, 3% 94%,
    2% 86%, 1% 78%, 3% 70%, 1% 62%, 3% 54%, 1% 46%, 3% 38%, 1% 30%, 3% 22%, 1% 14%
  );
}
.scrollInner{
  position:absolute; inset:0;
  padding:26px 30px 18px;
  font-family: "Cormorant Garamond", serif;
  color:rgba(35,18,8,0.90);
  text-shadow: 0 1px 0 rgba(255,255,255,0.18);
}
.scrollTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
  margin-bottom:10px;
  padding-right:6px;
}
.scrollTitle{
  font-family:"Cinzel", serif;
  font-weight:800;
  letter-spacing:3px;
  text-transform:uppercase;
  font-size:13px;
  color:rgba(40,22,8,0.92);
  text-shadow:0 1px 0 rgba(255,255,255,0.25);
}
.scrollClose{
  border:none;
  background:transparent;
  padding:6px 10px;
  cursor:pointer;
  font-family:"Cinzel", serif;
  font-weight:800;
  letter-spacing:2px;
  text-transform:uppercase;
  font-size:12px;
  color:rgba(45,24,10,0.55);
  text-shadow: 0 1px 0 rgba(255,255,255,0.25);
  outline: 2px solid rgba(45,24,10,0.28);
  outline-offset: -2px;
  border-radius:10px;
  box-shadow:
    0 0 0 1px rgba(0,0,0,0.08) inset,
    0 1px 0 rgba(255,255,255,0.18);
  opacity:0.9;
  transform:rotate(-1.5deg);
}
.scrollClose:hover{
  opacity:1;
  outline-color: rgba(45,24,10,0.38);
  color:rgba(45,24,10,0.62);
}
.scrollBody{
  height:calc(100% - 44px);
  display:flex;
  flex-direction:column;
  gap:10px;
  overflow:hidden;
}
.scrollLog{
  flex:1;
  overflow:auto;
  padding-right:10px;
  line-height:1.55;
  font-size:16px;
  letter-spacing:0.2px;
  color:rgba(35,18,8,0.90);
  filter: contrast(1.02);
}
.scrollLog .who{
  font-family:"IM Fell English", serif;
  font-weight:400;
  font-style:italic;
  letter-spacing:0.6px;
  text-transform:uppercase;
  color:rgba(60,28,10,0.86);
  margin-right:6px;
  font-size: 0.90em;
}
.scrollLog .mestre{ color:rgba(70,34,12,0.86); }
.scrollLog .shadow{ color:rgba(20,20,20,0.92); }
.scrollLog .titan{ color:rgba(55,25,10,0.86); }

.scrollInputBar{
  display:flex;
  align-items:center;
  gap:10px;
  padding:10px 12px;
  border-radius:12px;
  background:rgba(0,0,0,0.07);
  border:1px solid rgba(0,0,0,0.14);
}
.prompt{
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-weight:900;
  color:rgba(20,10,0,0.85);
  letter-spacing:1px;
}
#cmdInput{
  flex:1;
  border:none;
  outline:none;
  background:transparent;
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:13px;
  color:rgba(20,10,0,0.92);
}
#cmdInput::placeholder{ color:rgba(20,10,0,0.45); }

.typeLine{ margin:0 0 10px 0; white-space:pre-wrap; }
.cursor{
  display:inline-block;
  width:10px;
  height:16px;
  transform:translateY(3px);
  background:rgba(20,10,0,0.62);
  margin-left:4px;
  animation:cur 0.8s steps(1,end) infinite;
}
@keyframes cur{ 0%,49%{opacity:0} 50%,100%{opacity:1} }

.outputLine{
  margin:0 0 10px 0;
  color:rgba(20,10,0,0.92);
  font-size:15px;
}
.outputLine .sys{
  font-family:"IM Fell English", serif;
  font-style:italic;
  letter-spacing:0.6px;
  color:rgba(60,28,8,0.74);
}

body.scrollOpen .scrollPaper{
  animation:unroll 520ms cubic-bezier(.12,.92,.12,1) both;
}
@keyframes unroll{
  0%{ filter:blur(1px) contrast(1.02) saturate(.9); transform:scaleY(.70); }
  55%{ transform:scaleY(1.02); }
  100%{ filter:blur(0) contrast(1.06) saturate(.92); transform:scaleY(1); }
}

/* ===== PLAYLISTS OVERLAY ===== */
#playlistsOverlay{
  position:fixed; inset:0;
  z-index:95;
  display:none;
}
body.playlistsOpen #playlistsOverlay{ display:block; }
#playlistsOverlay .dim{
  position:absolute; inset:0;
  background:rgba(0,0,0,0.86);
  backdrop-filter: blur(3px);
  animation:dimIn 240ms ease both;
}
.plShell{
  position:absolute;
  left:50%; top:50%;
  transform:translate(-50%,-50%) scale(.96);
  width:min(980px, 94vw);
  height:min(620px, 84vh);
  border-radius:22px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(12,12,14,0.80);
  box-shadow: 0 44px 180px rgba(0,0,0,0.88);
  backdrop-filter: blur(18px);
  overflow:hidden;
  opacity:0;
  animation:hubIn 320ms cubic-bezier(.12,.92,.12,1) both;
}
.plTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:18px 18px 12px;
  border-bottom:1px solid rgba(255,255,255,0.08);
}
.plTitle{ display:flex; flex-direction:column; gap:6px; }
.plTitle b{
  color:rgba(255,255,255,0.92);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-size:18px;
}
.plTitle span{
  color:rgba(255,255,255,0.55);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
}
.plClose{
  border:none;
  cursor:pointer;
  padding:8px 12px;
  border-radius:999px;
  background: rgba(255,255,255,0.06);
  color:rgba(255,255,255,0.78);
  border:1px solid rgba(255,255,255,0.10);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}
.plClose:hover{ background: rgba(255,255,255,0.09); }
.plBody{
  height:calc(100% - 62px);
  display:grid;
  grid-template-columns: 320px 1fr;
  gap:14px;
  padding:14px;
}
.plLeft{
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
  box-shadow: inset 0 0 22px rgba(0,0,0,0.45);
  padding:12px;
  overflow:auto;
}
.plHint{
  margin-bottom:10px;
  color:rgba(255,255,255,0.55);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
}
.plList{ display:flex; flex-direction:column; gap:10px; }
.plItem{
  width:100%;
  border:none;
  cursor:pointer;
  text-align:left;
  padding:12px 12px;
  border-radius:16px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.25);
  color:rgba(255,255,255,0.88);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:800;
  letter-spacing:.2px;
  transition: transform .16s ease, background .16s ease, border-color .16s ease;
}
.plItem small{
  display:block;
  margin-top:4px;
  font-weight:600;
  color:rgba(255,255,255,0.55);
  font-size:12px;
}
.plItem:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.06); }
.plItem.active{
  border-color: rgba(255,255,255,0.22);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,140,70,0.18), rgba(0,0,0,0.28));
}
.plRight{
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.25);
  overflow:hidden;
  position:relative;
}
.plFrame{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:none;
}
@media (max-width: 860px){
  .plBody{ grid-template-columns: 1fr; }
  .plLeft{ max-height: 200px; }
}

/* ===== ADMIN OVERLAY ===== */
#adminOverlay{
  position:fixed; inset:0;
  z-index:98;
  display:none;
}
body.adminOpen #adminOverlay{ display:block; }
#adminOverlay .dim{
  position:absolute; inset:0;
  background:rgba(0,0,0,0.88);
  backdrop-filter: blur(3px);
  animation:dimIn 240ms ease both;
}
.adShell{
  position:absolute;
  left:50%; top:50%;
  transform:translate(-50%,-50%) scale(.96);
  width:min(840px, 94vw);
  height:min(560px, 84vh);
  border-radius:22px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(12,12,14,0.82);
  box-shadow: 0 44px 180px rgba(0,0,0,0.90);
  backdrop-filter: blur(18px);
  overflow:hidden;
  opacity:0;
  animation:hubIn 320ms cubic-bezier(.12,.92,.12,1) both;
}
.adTop{
  display:flex;
  align-items:center;
  justify-content:space-between;
  padding:18px 18px 12px;
  border-bottom:1px solid rgba(255,255,255,0.08);
}
.adTitle{ display:flex; flex-direction:column; gap:6px; }
.adTitle b{
  color:rgba(255,255,255,0.92);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-size:18px;
}
.adTitle span{
  color:rgba(255,255,255,0.55);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
}
.adClose{
  border:none;
  cursor:pointer;
  padding:8px 12px;
  border-radius:999px;
  background: rgba(255,255,255,0.06);
  color:rgba(255,255,255,0.78);
  border:1px solid rgba(255,255,255,0.10);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
}
.adClose:hover{ background: rgba(255,255,255,0.09); }
.adBody{
  height:calc(100% - 62px);
  padding:16px;
  overflow:auto;
}
.adPanel{
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(255,255,255,0.04);
  box-shadow: inset 0 0 22px rgba(0,0,0,0.45);
  padding:16px;
}
.adLoginGrid{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:12px;
  margin-top:12px;
}
.adLabel{
  color:rgba(255,255,255,0.65);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
  margin-bottom:6px;
}
.adInput{
  width:100%;
  padding:12px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.35);
  color:rgba(255,255,255,0.88);
  outline:none;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:700;
}
.adInput:focus{
  border-color: rgba(255,255,255,0.22);
  box-shadow: 0 0 0 3px rgba(255,140,70,0.10);
}
.adActions{
  display:flex;
  gap:10px;
  margin-top:14px;
  flex-wrap:wrap;
}
.adBtn{
  border:none;
  cursor:pointer;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.35);
  color:rgba(255,255,255,0.84);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  letter-spacing:1px;
  text-transform:uppercase;
  font-size:12px;
  transition: transform .15s ease, background .15s ease;
}
.adBtn:hover{ transform: translateY(-1px); background: rgba(255,255,255,0.06); }
.adBtn.primary{
  background: radial-gradient(circle at 30% 30%, rgba(255,140,70,0.20), rgba(0,0,0,0.35));
  border-color: rgba(255,255,255,0.18);
}
.adMsg{
  margin-top:12px;
  color:rgba(255,255,255,0.68);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:700;
}
.adDash{ display:none; }
.adGrid{
  display:grid;
  grid-template-columns: repeat(3, minmax(0,1fr));
  gap:12px;
  margin-top:12px;
}
.adMetric{
  border-radius:18px;
  border:1px solid rgba(255,255,255,0.10);
  background: rgba(0,0,0,0.28);
  padding:14px;
}
.adMetric .k{
  color:rgba(255,255,255,0.55);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
  letter-spacing:1px;
  text-transform:uppercase;
}
.adMetric .v{
  margin-top:8px;
  font-size:30px;
  color:rgba(255,255,255,0.92);
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  font-weight:900;
}
.adUpdated{
  margin-top:10px;
  color:rgba(255,255,255,0.45);
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
  font-size:12px;
}
@media (max-width: 820px){
  .adGrid{ grid-template-columns: repeat(2, minmax(0,1fr)); }
  .adLoginGrid{ grid-template-columns: 1fr; }
}

@media (prefers-reduced-motion: reduce){
  .title, .sub{ animation:none; }
  .title::before{ display:none; }
  body.entered:not(.menuSeen) .menuBtn{ animation:none; }
}
</style>
</head>

<body>

<video id="mainVideo"
  src="https://files.catbox.moe/klaol5.webm"
  playsinline preload="auto" loop></video>

<audio id="bgAudio" src="https://files.catbox.moe/99fu05.m4a" preload="auto"></audio>

<section id="entry" tabindex="0" aria-label="Entrada Shadow Fight 2">
  <div class="bgFill"></div>
  <canvas id="ashCanvas"></canvas>

  <div class="stage">
    <div class="frameWrap">
      <img class="frame" src="https://files.catbox.moe/5yp48z.png" alt="Shadow Fight 2 Entry">
      <div class="softOverlay"></div>
      <img id="strike" class="frame" src="https://files.catbox.moe/er48bx.gif" alt="Golpe">

      <div class="introUI">
        <div>
          <div class="title">ENTER</div>
          <div class="sub">
            pressione <span class="kbdEnter">ENTER
              <svg viewBox="0 0 24 24" fill="none">
                <path d="M8 7v5h10" stroke="rgba(255,220,190,0.85)" stroke-width="1.6" stroke-linecap="round"/>
                <path d="M14 9l4 3-4 3" stroke="rgba(255,220,190,0.85)" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M8 12H6" stroke="rgba(255,220,190,0.85)" stroke-width="1.6" stroke-linecap="round"/>
              </svg>
            </span>
            / clique
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ===== VOLUME ===== -->
<div id="grimoire" aria-label="Controle de volume">
  <button class="grimoireBtn" id="grimBtn" aria-label="Abrir controle de volume">
    <span class="grimoireIcon" aria-hidden="true">
      <svg viewBox="0 0 24 24" fill="none">
        <path d="M4 10v4h4l5 4V6L8 10H4Z" fill="rgba(255,220,190,0.85)"/>
        <path d="M16 9c1 .8 1.5 1.8 1.5 3s-.5 2.2-1.5 3" stroke="rgba(255,140,70,0.85)" stroke-width="1.6" stroke-linecap="round"/>
        <path d="M18.5 7.5c1.6 1.5 2.5 3 2.5 4.5s-.9 3-2.5 4.5" stroke="rgba(255,140,70,0.55)" stroke-width="1.4" stroke-linecap="round"/>
      </svg>
    </span>
  </button>

  <div class="panel">
    <div class="row">
      <input id="vol" type="range" min="0" max="100" value="8" />
      <div class="volValue" id="volValue">8%</div>
    </div>
  </div>
</div>

<!-- ===== FULLSCREEN ===== -->
<div id="fsWrap" aria-label="Tela cheia">
  <button class="fsBtn" id="fsBtn" aria-label="Ativar/desativar tela cheia">
    <svg viewBox="0 0 24 24" fill="none">
      <path d="M9 4H6a2 2 0 0 0-2 2v3" stroke="rgba(255,220,190,0.9)" stroke-width="1.6" stroke-linecap="round"/>
      <path d="M15 4h3a2 2 0 0 1 2 2v3" stroke="rgba(255,220,190,0.9)" stroke-width="1.6" stroke-linecap="round"/>
      <path d="M9 20H6a2 2 0 0 1-2-2v-3" stroke="rgba(255,220,190,0.9)" stroke-width="1.6" stroke-linecap="round"/>
      <path d="M15 20h3a2 2 0 0 0 2-2v-3" stroke="rgba(255,220,190,0.9)" stroke-width="1.6" stroke-linecap="round"/>
    </svg>
  </button>
</div>

<!-- ===== BOTÃO DO PERGAMINHO ===== -->
<button id="scrollBtn" aria-label="Abrir pergaminho (lore)">
  <svg viewBox="0 0 24 24" fill="none">
    <path d="M7 5h10v12a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2V5Z" stroke="rgba(255,220,190,0.9)" stroke-width="1.6" />
    <path d="M7 8h10" stroke="rgba(255,140,70,0.7)" stroke-width="1.4" stroke-linecap="round"/>
    <path d="M7 11h8" stroke="rgba(255,140,70,0.55)" stroke-width="1.4" stroke-linecap="round"/>
    <path d="M7 14h9" stroke="rgba(255,140,70,0.45)" stroke-width="1.4" stroke-linecap="round"/>
  </svg>
</button>

<!-- ===== BOTÃO ADMIN ===== -->
<button id="adminBtn" aria-label="Abrir admin">
  <svg viewBox="0 0 24 24" fill="none">
    <path d="M12 3a4 4 0 0 1 4 4v2" stroke="rgba(255,220,190,0.9)" stroke-width="1.6" stroke-linecap="round"/>
    <path d="M8 9h8a4 4 0 0 1 4 4v4a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3v-4a4 4 0 0 1 4-4Z" stroke="rgba(255,220,190,0.9)" stroke-width="1.6"/>
    <path d="M12 13v3" stroke="rgba(255,140,70,0.7)" stroke-width="1.6" stroke-linecap="round"/>
  </svg>
</button>

<!-- ===== MENU ===== -->
<div id="menuWrap" aria-label="Menu">
  <button class="menuBtn" id="menuBtn" aria-label="Abrir menu">
    <svg viewBox="0 0 24 24" fill="none">
      <path d="M5 7h14" stroke="rgba(255,220,190,0.9)" stroke-width="1.6" stroke-linecap="round"/>
      <path d="M5 12h14" stroke="rgba(255,140,70,0.65)" stroke-width="1.6" stroke-linecap="round"/>
      <path d="M5 17h14" stroke="rgba(255,220,190,0.85)" stroke-width="1.6" stroke-linecap="round"/>
    </svg>
  </button>

  <div class="menuDrop" id="menuDrop">
    <button class="menuItem" id="openSocial">
      Social Media <span class="tag">V2.0</span>
    </button>
    <button class="menuItem" id="openArchives">
      Archives <span class="tag">placeholder</span>
    </button>
    <button class="menuItem" id="openPlaylists">
      Playlists <span class="tag">V2.1</span>
    </button>
  </div>
</div>

<!-- ===== OVERLAY DO PERGAMINHO ===== -->
<div id="scrollOverlay" aria-hidden="true">
  <div class="dim"></div>

  <div class="scroll" role="dialog" aria-label="Pergaminho">
    <div class="scrollMask">
      <div class="scrollPaper">
        <div class="scrollInner">
          <div class="scrollTop">
            <div class="scrollTitle">Pergaminho — Vozes nas Sombras</div>
            <button class="scrollClose" id="scrollClose">FECHAR</button>
          </div>

          <div class="scrollBody">
            <div class="scrollLog" id="scrollLog">
              <div class="typeLine" id="typeLine"></div><span class="cursor" id="cursor"></span>
              <div id="out"></div>
            </div>

            <div class="scrollInputBar">
              <div class="prompt">&gt;</div>
              <input id="cmdInput" autocomplete="off" spellcheck="false"
                     placeholder="digite um comando (ex: hub, arquivo, lore, ajuda) e ENTER">
            </div>
          </div>

        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== SOCIAL MEDIA OVERLAY ===== -->
<div id="socialOverlay" aria-hidden="true">
  <div class="dim"></div>

  <div class="smCard" role="dialog" aria-label="Social Media">
    <div class="smHead">
      <div class="smTitle">SOCIAL MEDIA</div>
      <button class="smClose" id="socialClose">FECHAR</button>
    </div>

    <div class="smBody">
      <div class="smProfile">
        <div class="smAvatar">
          <img id="smAvatar" src="https://files.catbox.moe/5lkce6.gif" alt="Avatar Allz">
        </div>

        <div class="smName" id="smName">Allz</div>
        <div class="smBio" id="smBio">awake and unafraid</div>

        <div class="smLoc" id="smLoc">
          <svg viewBox="0 0 24 24" fill="none">
            <path d="M12 21s7-5.2 7-12a7 7 0 0 0-14 0c0 6.8 7 12 7 12Z" stroke="rgba(255,255,255,0.75)" stroke-width="1.6"/>
            <path d="M12 12a2.4 2.4 0 1 0 0-4.8 2.4 2.4 0 0 0 0 4.8Z" fill="rgba(255,255,255,0.65)"/>
          </svg>
          purgatório
        </div>

        <div class="smIcons" aria-label="Links">
          <a class="smIconBtn" href="https://tiktok.com/@allzdeadd" target="_blank" rel="noopener" aria-label="TikTok">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M14 4v10.2a3.2 3.2 0 1 1-2.2-3.05V8.2c-.3 0-.6-.02-.9-.07V5.1A7.6 7.6 0 0 0 14 4Z" fill="rgba(255,255,255,0.85)"/>
            </svg>
          </a>

          <a class="smIconBtn" href="https://open.spotify.com/user/allzdeadd" target="_blank" rel="noopener" aria-label="Spotify">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M12 2a10 10 0 1 0 0 20 10 10 0 0 0 0-20Zm4.6 14.4a.9.9 0 0 1-1.24.3c-2.8-1.7-6.3-2.1-10.3-1.2a.9.9 0 0 1-.4-1.75c4.4-1 8.3-.5 11.5 1.4.42.25.56.8.3 1.25Zm1.3-3a1 1 0 0 1-1.37.33c-3.2-2-8-2.6-11.6-1.4a1 1 0 0 1-.6-1.9c4.1-1.3 9.3-.7 13 1.6.47.3.62.92.33 1.37Zm.1-3.2c-3.8-2.3-10-2.5-13.6-1.4a1.1 1.1 0 0 1-.65-2.1c4.2-1.3 11.1-1 15.5 1.7a1.1 1.1 0 1 1-1.1 1.8Z" fill="rgba(255,255,255,0.85)"/>
            </svg>
          </a>

          <a class="smIconBtn" href="https://instagram.com/allzdeadd" target="_blank" rel="noopener" aria-label="Instagram">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M7 2h10a5 5 0 0 1 5 5v10a5 5 0 0 1-5 5H7a5 5 0 0 1-5-5V7a5 5 0 0 1 5-5Z" stroke="rgba(255,255,255,0.85)" stroke-width="1.6"/>
              <path d="M12 16.2A4.2 4.2 0 1 0 12 7.8a4.2 4.2 0 0 0 0 8.4Z" stroke="rgba(255,255,255,0.85)" stroke-width="1.6"/>
              <path d="M17.6 6.4h.01" stroke="rgba(255,255,255,0.85)" stroke-width="3" stroke-linecap="round"/>
            </svg>
          </a>

          <a class="smIconBtn" href="https://x.com/allzdeadd" target="_blank" rel="noopener" aria-label="X">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M5 19L19 5" stroke="rgba(255,255,255,0.85)" stroke-width="1.8" stroke-linecap="round"/>
              <path d="M7 5h5l5 14h-5L7 5Z" fill="rgba(255,255,255,0.75)"/>
            </svg>
          </a>

          <a class="smIconBtn" href="https://allzdeadd" target="_blank" rel="noopener" aria-label="Link">
            <svg viewBox="0 0 24 24" fill="none">
              <path d="M10 13a4 4 0 0 1 0-6l1-1a4 4 0 0 1 6 6l-1 1" stroke="rgba(255,255,255,0.85)" stroke-width="1.6" stroke-linecap="round"/>
              <path d="M14 11a4 4 0 0 1 0 6l-1 1a4 4 0 0 1-6-6l1-1" stroke="rgba(255,255,255,0.85)" stroke-width="1.6" stroke-linecap="round"/>
            </svg>
          </a>
        </div>
      </div>

      <div class="smSection">
        <div class="smSectionTitle">
          <span>DISCORD STATUS</span>
          <span class="smStatusPill" id="smStatusPill" data-status="idle">
            <span class="smDot"></span>
            <span id="smStatusText">Ausente</span>
          </span>
        </div>

        <div class="smRow">
          <div class="smDiscIcon" aria-label="Avatar Discord">
            <img id="dAvatar" alt="Avatar Discord">
            <svg id="dFallback" viewBox="0 0 24 24" fill="none" style="width:22px;height:22px;opacity:.85">
              <path d="M8.5 7.5c1.2-.9 2.5-1.3 3.5-1.3s2.3.4 3.5 1.3" stroke="rgba(255,255,255,0.85)" stroke-width="1.6" stroke-linecap="round"/>
              <path d="M7 17c1.5-1.2 3.2-1.7 5-1.7s3.5.5 5 1.7" stroke="rgba(255,255,255,0.85)" stroke-width="1.6" stroke-linecap="round"/>
              <path d="M6 9.5c-1.2 2.9-1 5.8.6 8.5" stroke="rgba(255,255,255,0.55)" stroke-width="1.4" stroke-linecap="round"/>
              <path d="M18 9.5c1.2 2.9 1 5.8-.6 8.5" stroke="rgba(255,255,255,0.55)" stroke-width="1.4" stroke-linecap="round"/>
            </svg>
          </div>

          <div class="smDiscText">
            <div class="smDiscName" id="smDiscordName">Allz</div>
            <div class="smDiscSub" id="smDiscordSub">@allzz.exe</div>
          </div>
        </div>

        <div class="smFoot" id="smUpdatedAt">atualizando...</div>
      </div>

      <div class="smFoot"><span id="smViews">0</span> views</div>
    </div>
  </div>
</div>

<!-- ===== EDIT/HUB OVERLAY (AUTO) ===== -->
<div id="editOverlay" aria-hidden="true">
  <div class="dim"></div>

  <div class="hubShell" role="dialog" aria-label="Edit / Hub">
    <div class="hubTop">
      <div class="hubTitle">
        <b>EDIT / HUB</b>
        <span>apresentação automática</span>
      </div>
      <button class="hubClose" id="hubClose">FECHAR</button>
    </div>

    <div class="hubBody">
      <div class="hubMain">
        <div class="hubMainInner">
          <div class="hubBig">
            <!-- placeholder visual usando seu próprio vídeo -->
            <video src="https://files.catbox.moe/klaol5.webm" muted autoplay loop playsinline></video>
            <div class="hint">troque aqui pela sua EDIT depois</div>
          </div>

          <div class="hubCards">
            <div class="hubCard">
              <div class="k">Tema</div>
              <div class="v">Shadow Fight 2</div>
            </div>
            <div class="hubCard">
              <div class="k">Lore</div>
              <div class="v">Sombras • Titan</div>
            </div>
            <div class="hubCard">
              <div class="k">V2.1</div>
              <div class="v">Playlists + Admin</div>
            </div>
          </div>
        </div>
      </div>

      <div class="hubSide">
        <div class="hubSideTitle">Como explorar</div>
        <div class="hubSideText">
          Use o <b>MENU</b> no canto superior direito para abrir:
          <br><br>
          • Social Media<br>
          • Playlists (Spotify)<br>
          • Archives (placeholder)
          <br><br>
          E o botão do <b>Pergaminho</b> para a lore/terminal.
        </div>

        <div class="hubPills">
          <div class="hubPill">menu</div>
          <div class="hubPill">pergaminho</div>
          <div class="hubPill">playlists</div>
          <div class="hubPill">admin</div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== PLAYLISTS OVERLAY ===== -->
<div id="playlistsOverlay" aria-hidden="true">
  <div class="dim"></div>

  <div class="plShell" role="dialog" aria-label="Playlists">
    <div class="plTop">
      <div class="plTitle">
        <b>Playlists</b>
        <span>pessoal • spotify • v2.1</span>
      </div>
      <button class="plClose" id="plClose">FECHAR</button>
    </div>

    <div class="plBody">
      <div class="plLeft">
        <div class="plHint">selecione uma playlist</div>
        <div class="plList" id="plList"></div>
      </div>

      <div class="plRight">
        <iframe class="plFrame" id="plFrame"
          allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"
          loading="lazy"></iframe>
      </div>
    </div>
  </div>
</div>

<!-- ===== ADMIN OVERLAY ===== -->
<div id="adminOverlay" aria-hidden="true">
  <div class="dim"></div>

  <div class="adShell" role="dialog" aria-label="Admin">
    <div class="adTop">
      <div class="adTitle">
        <b>Admin</b>
        <span>confidencial • métricas locais</span>
      </div>
      <button class="adClose" id="adClose">FECHAR</button>
    </div>

    <div class="adBody">
      <div class="adPanel">

        <div id="adLogin">
          <div class="adMsg" id="adMsg">Acesso restrito.</div>

          <div class="adLoginGrid">
            <div>
              <div class="adLabel">Usuário</div>
              <input class="adInput" id="adUser" autocomplete="off" spellcheck="false" placeholder="Sombra">
            </div>
            <div>
              <div class="adLabel">Senha</div>
              <input class="adInput" id="adPass" type="password" autocomplete="off" placeholder="Projeto26">
            </div>
          </div>

          <div class="adActions">
            <button class="adBtn primary" id="adLoginBtn">Entrar</button>
            <button class="adBtn" id="adLoginHint">Dica</button>
          </div>
        </div>

        <div class="adDash" id="adDash">
          <div class="adMsg">Dashboard confidencial.</div>

          <div class="adGrid" id="adGrid"></div>
          <div class="adUpdated" id="adUpdated">Atualizando...</div>

          <div class="adActions" style="margin-top:14px">
            <button class="adBtn" id="adResetBtn">Reset métricas</button>
            <button class="adBtn" id="adLogoutBtn">Sair</button>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<script>
/* =========================
   BASE
   ========================= */
const entry = document.getElementById("entry");
const mainVideo = document.getElementById("mainVideo");
const bgAudio = document.getElementById("bgAudio");

/* ===== VOLUME PADRÃO 8% ===== */
let currentVol = 0.08;
bgAudio.volume = currentVol;

/* ===== CINZAS ===== */
const canvas = document.getElementById("ashCanvas");
const ctx = canvas.getContext("2d");
let W=0, H=0;

function resize(){
  canvas.width = innerWidth;
  canvas.height = innerHeight;
  W = innerWidth; H = innerHeight;
}
resize();
addEventListener("resize", resize);

const ash=[];
const ASH_N = 190;
for(let i=0;i<ASH_N;i++){
  ash.push({
    x:Math.random()*W,
    y:Math.random()*H,
    r:Math.random()*2.2+0.5,
    v:Math.random()*0.62+0.18,
    drift:(Math.random()-0.5)*0.55,
    tw:Math.random()*0.9+0.1
  });
}
function drawAsh(){
  ctx.clearRect(0,0,W,H);
  for(const p of ash){
    p.y -= p.v;
    p.x += p.drift;
    if(p.y < -12){ p.y = H + 12; p.x = Math.random()*W; }
    if(p.x < -12) p.x = W + 12;
    if(p.x > W + 12) p.x = -12;
    const a = 0.08 + p.tw*0.16;
    ctx.beginPath();
    ctx.fillStyle = `rgba(210,210,210,${a})`;
    ctx.arc(p.x, p.y, p.r, 0, Math.PI*2);
    ctx.fill();
  }
  requestAnimationFrame(drawAsh);
}
drawAsh();

/* =========================
   ÁUDIO pause/resume
   ========================= */
let audioWasPlaying = false;
function pauseBgAudio(){
  try{
    audioWasPlaying = !bgAudio.paused && !bgAudio.ended && bgAudio.currentTime > 0;
    bgAudio.pause();
  }catch(e){}
}
async function resumeBgAudio(){
  try{
    if(audioWasPlaying){
      bgAudio.volume = currentVol;
      await bgAudio.play();
    }
  }catch(e){}
}

/* =========================
   OVERLAYS helpers
   ========================= */
const scrollOverlay = document.getElementById("scrollOverlay");
const socialOverlay = document.getElementById("socialOverlay");
const playlistsOverlay = document.getElementById("playlistsOverlay");
const adminOverlay = document.getElementById("adminOverlay");
const editOverlay = document.getElementById("editOverlay");

const overlayFlags = ["scrollOpen","socialOpen","playlistsOpen","adminOpen","editOpen"];

function closeAllOverlays(){
  document.body.classList.remove(...overlayFlags);
  scrollOverlay?.setAttribute("aria-hidden","true");
  socialOverlay?.setAttribute("aria-hidden","true");
  playlistsOverlay?.setAttribute("aria-hidden","true");
  adminOverlay?.setAttribute("aria-hidden","true");
  editOverlay?.setAttribute("aria-hidden","true");
}

function openOverlay(flag){
  if(!document.body.classList.contains("entered")) return;
  closeAllOverlays();
  pauseBgAudio();
  document.body.classList.add(flag);
  if(flag==="scrollOpen") scrollOverlay.setAttribute("aria-hidden","false");
  if(flag==="socialOpen") socialOverlay.setAttribute("aria-hidden","false");
  if(flag==="playlistsOpen") playlistsOverlay.setAttribute("aria-hidden","false");
  if(flag==="adminOpen") adminOverlay.setAttribute("aria-hidden","false");
  if(flag==="editOpen") editOverlay.setAttribute("aria-hidden","false");
}

function closeOverlay(flag){
  document.body.classList.remove(flag);
  if(flag==="scrollOpen") scrollOverlay.setAttribute("aria-hidden","true");
  if(flag==="socialOpen") socialOverlay.setAttribute("aria-hidden","true");
  if(flag==="playlistsOpen") playlistsOverlay.setAttribute("aria-hidden","true");
  if(flag==="adminOpen") adminOverlay.setAttribute("aria-hidden","true");
  if(flag==="editOpen") editOverlay.setAttribute("aria-hidden","true");
  resumeBgAudio();
}

/* =========================
   CLICK / ENTER
   ========================= */
let started=false;
async function start(){
  if(started) return;
  started=true;

  document.body.classList.add("strikeOn");

  try{
    bgAudio.currentTime = 0;
    bgAudio.volume = currentVol;
    await bgAudio.play();
  }catch(e){}

  setTimeout(async ()=>{
    try{
      mainVideo.muted = true;
      await mainVideo.play();
    }catch(e){}
    document.body.classList.add("entered");

    // AUTO ABRIR EDIT/HUB (uma vez por sessão)
    try{
      const seen = sessionStorage.getItem("hub_auto_shown");
      if(!seen){
        sessionStorage.setItem("hub_auto_shown","1");
        setTimeout(()=> openEditOverlay(), 900);
      }
    }catch(e){}
  }, 1050);
}
entry.addEventListener("pointerdown", start);
entry.addEventListener("keydown", (e)=>{
  if(e.key==="Enter" || e.key===" "){ e.preventDefault(); start(); }
});

/* =========================
   VOLUME
   ========================= */
const grimoire = document.getElementById("grimoire");
const grimBtn = document.getElementById("grimBtn");
const vol = document.getElementById("vol");
const volValue = document.getElementById("volValue");

function setSliderVisual(v){
  vol.style.setProperty("--p", `${v}%`);
  volValue.textContent = `${v}%`;
}
setSliderVisual(8);

grimBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  grimoire.classList.toggle("open");
});
document.addEventListener("click",(e)=>{
  if(!grimoire.contains(e.target)) grimoire.classList.remove("open");
});
vol.addEventListener("input", ()=>{
  const v = Number(vol.value);
  setSliderVisual(v);
  currentVol = v/100;
  bgAudio.volume = currentVol;
});

/* =========================
   FULLSCREEN
   ========================= */
const fsBtn = document.getElementById("fsBtn");
async function toggleFullscreen(){
  try{
    if(!document.fullscreenElement){
      await document.documentElement.requestFullscreen();
    }else{
      await document.exitFullscreen();
    }
  }catch(e){}
}
fsBtn.addEventListener("click", (e)=>{
  e.stopPropagation();
  toggleFullscreen();
});

/* =========================
   MENU (top-right)
   ========================= */
const menuWrap = document.getElementById("menuWrap");
const menuBtn = document.getElementById("menuBtn");
const openSocial = document.getElementById("openSocial");
const openArchives = document.getElementById("openArchives");
const openPlaylists = document.getElementById("openPlaylists");

menuBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  if(!document.body.classList.contains("entered")) return;
  document.body.classList.add("menuSeen"); // para a animação chamativa
  menuWrap.classList.toggle("open");
});
document.addEventListener("click",(e)=>{
  if(!menuWrap.contains(e.target)) menuWrap.classList.remove("open");
});

openArchives.addEventListener("click", ()=>{
  menuWrap.classList.remove("open");
  alert("Archives (placeholder) — V2.1");
});

/* =========================
   EDIT/HUB overlay (auto)
   ========================= */
const hubClose = document.getElementById("hubClose");
function openEditOverlay(){
  menuWrap.classList.remove("open");
  openOverlay("editOpen");
  setTimeout(()=>hubClose.focus(), 80);
}
function closeEditOverlay(){ closeOverlay("editOpen"); }

hubClose.addEventListener("click", closeEditOverlay);
editOverlay.addEventListener("click",(e)=>{
  if(e.target.classList.contains("dim")) closeEditOverlay();
});

/* =========================
   SOCIAL OVERLAY
   ========================= */
const socialClose = document.getElementById("socialClose");
const smViews = document.getElementById("smViews");
const smStatusPill = document.getElementById("smStatusPill");
const smStatusText = document.getElementById("smStatusText");
const smUpdatedAt = document.getElementById("smUpdatedAt");

const smDiscordName = document.getElementById("smDiscordName");
const smDiscordSub = document.getElementById("smDiscordSub");
const dAvatar = document.getElementById("dAvatar");
const dFallback = document.getElementById("dFallback");

function incLocal(key){
  const v = Number(localStorage.getItem(key) || "0") + 1;
  localStorage.setItem(key, String(v));
  return v;
}

function openSocialOverlay(){
  if(!document.body.classList.contains("entered")) return;
  menuWrap.classList.remove("open");
  openOverlay("socialOpen");

  const v = incLocal("sm_views");
  smViews.textContent = String(v);

  fetchLanyard();
  setTimeout(()=>socialClose.focus(), 80);
}
function closeSocialOverlay(){ closeOverlay("socialOpen"); }

openSocial.addEventListener("click", ()=>{
  menuWrap.classList.remove("open");
  openSocialOverlay();
});
socialClose.addEventListener("click", closeSocialOverlay);
socialOverlay.addEventListener("click",(e)=>{
  if(e.target.classList.contains("dim")) closeSocialOverlay();
});

const LANYARD_USER_ID = "513830615225860096";
const LANYARD_URL = `https://api.lanyard.rest/v1/users/${LANYARD_USER_ID}`;

function mapStatusPT(s){
  if(s === "online") return "Online";
  if(s === "idle") return "Ausente";
  if(s === "dnd") return "Não perturbe";
  return "Offline";
}
function statusToPill(s){
  smStatusPill.dataset.status = s || "offline";
  smStatusText.textContent = mapStatusPT(s || "offline");
}
function setUpdatedNow(){
  const d = new Date();
  const hh = String(d.getHours()).padStart(2,"0");
  const mm = String(d.getMinutes()).padStart(2,"0");
  smUpdatedAt.textContent = `atualizado às ${hh}:${mm}`;
}
async function fetchLanyard(){
  statusToPill("idle");
  setUpdatedNow();

  try{
    const r = await fetch(LANYARD_URL, { cache:"no-store" });
    if(!r.ok) throw new Error("lanyard http");
    const j = await r.json();
    const data = j?.data;
    if(!data) throw new Error("lanyard data");

    const st = data.discord_status || "offline";
    statusToPill(st);

    const dn =
      data.discord_user?.global_name ||
      data.discord_user?.display_name ||
      data.discord_user?.username ||
      "Allz";
    smDiscordName.textContent = dn;
    smDiscordSub.textContent = "@allzz.exe";

    const uid = data.discord_user?.id || LANYARD_USER_ID;
    const av = data.discord_user?.avatar;
    if(av){
      const isAnim = av.startsWith("a_");
      const ext = isAnim ? "gif" : "png";
      const url = `https://cdn.discordapp.com/avatars/${uid}/${av}.${ext}?size=256`;
      dAvatar.src = url;
      dAvatar.style.display = "block";
      dFallback.style.display = "none";
    }else{
      dAvatar.style.display = "none";
      dFallback.style.display = "block";
    }
    setUpdatedNow();
  }catch(e){
    // mantém fallback
  }
}

/* =========================
   PLAYLISTS OVERLAY
   ========================= */
const plClose = document.getElementById("plClose");
const plList = document.getElementById("plList");
const plFrame = document.getElementById("plFrame");

const PLAYLISTS = [
  {
    name: "Shadow Vibes",
    desc: "sombras • combate • foco",
    embed: "https://open.spotify.com/embed/playlist/37i9dQZF1DX0XUsuxWHRQd?utm_source=generator"
  },
  {
    name: "Midnight",
    desc: "noite • chill • dark",
    embed: "https://open.spotify.com/embed/playlist/37i9dQZF1DX4fpCWaHOned?utm_source=generator"
  },
  {
    name: "Favorites",
    desc: "minhas faixas",
    embed: "https://open.spotify.com/embed/playlist/37i9dQZF1DXcBWIGoYBM5M?utm_source=generator"
  }
];

function escapeHtml(s){
  return String(s)
    .replaceAll("&","&amp;")
    .replaceAll("<","&lt;")
    .replaceAll(">","&gt;")
    .replaceAll('"',"&quot;")
    .replaceAll("'","&#039;");
}

function renderPlaylistList(){
  plList.innerHTML = "";
  PLAYLISTS.forEach((p, idx)=>{
    const btn = document.createElement("button");
    btn.className = "plItem";
    btn.type = "button";
    btn.innerHTML = `${escapeHtml(p.name)}<small>${escapeHtml(p.desc)}</small>`;
    btn.addEventListener("click", ()=> setActivePlaylist(idx));
    plList.appendChild(btn);
  });
}
function setActivePlaylist(i){
  const items = [...plList.querySelectorAll(".plItem")];
  items.forEach((el, idx)=> el.classList.toggle("active", idx===i));
  const p = PLAYLISTS[i];
  plFrame.src = p.embed;
  localStorage.setItem("pl_last", String(i));
}
function openPlaylistsOverlay(){
  if(!document.body.classList.contains("entered")) return;
  menuWrap.classList.remove("open");
  openOverlay("playlistsOpen");

  renderPlaylistList();
  const last = Number(localStorage.getItem("pl_last") || "0");
  const safe = Number.isFinite(last) ? Math.max(0, Math.min(last, PLAYLISTS.length-1)) : 0;
  setActivePlaylist(safe);

  setTimeout(()=>plClose.focus(), 80);
}
function closePlaylistsOverlay(){
  plFrame.src = "about:blank";
  closeOverlay("playlistsOpen");
}
openPlaylists.addEventListener("click", ()=>{
  menuWrap.classList.remove("open");
  openPlaylistsOverlay();
});
plClose.addEventListener("click", closePlaylistsOverlay);
playlistsOverlay.addEventListener("click",(e)=>{
  if(e.target.classList.contains("dim")) closePlaylistsOverlay();
});

/* =========================
   ADMIN OVERLAY
   ========================= */
const adminBtn = document.getElementById("adminBtn");
const adClose = document.getElementById("adClose");

const adLogin = document.getElementById("adLogin");
const adDash = document.getElementById("adDash");
const adMsg = document.getElementById("adMsg");

const adUser = document.getElementById("adUser");
const adPass = document.getElementById("adPass");
const adLoginBtn = document.getElementById("adLoginBtn");
const adLoginHint = document.getElementById("adLoginHint");

const adGrid = document.getElementById("adGrid");
const adUpdated = document.getElementById("adUpdated");
const adResetBtn = document.getElementById("adResetBtn");
const adLogoutBtn = document.getElementById("adLogoutBtn");

const ADMIN_USER = "Sombra";
const ADMIN_PASS = "Projeto26";
const ADMIN_OK_KEY = "admin_ok";

function nowHHMM(){
  const d = new Date();
  return `${String(d.getHours()).padStart(2,"0")}:${String(d.getMinutes()).padStart(2,"0")}`;
}
function metricGet(key){ return Number(localStorage.getItem(key) || "0"); }
function metricSet(key, v){ localStorage.setItem(key, String(v)); }
function metricInc(key){
  const v = metricGet(key)+1;
  metricSet(key, v);
  return v;
}
function buildAdminMetrics(){
  const metrics = [
    { key:"m_site_opens", label:"Site Opens" },
    { key:"m_social_opens", label:"Social Opens" },
    { key:"m_scroll_opens", label:"Scroll Opens" },
    { key:"m_playlists_opens", label:"Playlists Opens" },
    { key:"m_admin_logins", label:"Admin Logins" }
  ];
  adGrid.innerHTML = "";
  metrics.forEach(m=>{
    const card = document.createElement("div");
    card.className = "adMetric";
    card.innerHTML = `<div class="k">${escapeHtml(m.label)}</div><div class="v">${metricGet(m.key)}</div>`;
    adGrid.appendChild(card);
  });
  adUpdated.textContent = `Atualizado às ${nowHHMM()}`;
}
function showAdminLogin(msg){
  adLogin.style.display = "block";
  adDash.style.display = "none";
  if(msg) adMsg.textContent = msg;
}
function showAdminDash(){
  adLogin.style.display = "none";
  adDash.style.display = "block";
  buildAdminMetrics();
}
function openAdminOverlay(){
  if(!document.body.classList.contains("entered")) return;
  openOverlay("adminOpen");
  setTimeout(()=>adClose.focus(), 80);

  if(localStorage.getItem(ADMIN_OK_KEY)==="1"){
    showAdminDash();
  }else{
    showAdminLogin("Acesso restrito.");
    setTimeout(()=>adUser.focus(), 120);
  }
}
function closeAdminOverlay(){ closeOverlay("adminOpen"); }

adminBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  openAdminOverlay();
});
adClose.addEventListener("click", closeAdminOverlay);
adminOverlay.addEventListener("click",(e)=>{
  if(e.target.classList.contains("dim")) closeAdminOverlay();
});

adLoginHint.addEventListener("click", ()=>{
  adMsg.textContent = "Usuário fixo: Sombra • Senha: Projeto26";
});
function tryLogin(){
  const u = (adUser.value || "").trim();
  const p = (adPass.value || "").trim();
  if(u === ADMIN_USER && p === ADMIN_PASS){
    localStorage.setItem(ADMIN_OK_KEY, "1");
    metricInc("m_admin_logins");
    showAdminDash();
    adUser.value = "";
    adPass.value = "";
  }else{
    adMsg.textContent = "Credenciais inválidas.";
  }
}
adLoginBtn.addEventListener("click", tryLogin);
adPass.addEventListener("keydown",(e)=>{
  if(e.key==="Enter") tryLogin();
});
adResetBtn.addEventListener("click", ()=>{
  const keys = ["m_site_opens","m_social_opens","m_scroll_opens","m_playlists_opens","m_admin_logins"];
  keys.forEach(k=> localStorage.removeItem(k));
  buildAdminMetrics();
  adMsg.textContent = "Métricas resetadas.";
});
adLogoutBtn.addEventListener("click", ()=>{
  localStorage.removeItem(ADMIN_OK_KEY);
  showAdminLogin("Sessão encerrada.");
});

/* =========================
   PERGAMINHO
   ========================= */
const scrollBtn = document.getElementById("scrollBtn");
const scrollClose = document.getElementById("scrollClose");
const scrollLog = document.getElementById("scrollLog");
const typeLine = document.getElementById("typeLine");
const cursor = document.getElementById("cursor");
const out = document.getElementById("out");
const cmdInput = document.getElementById("cmdInput");

let typing = false;
let typedOnce = false;

const loreLines = [
  `<span class="who mestre">MESTRE:</span> A arena está silenciosa... mas as sombras nunca dormem.`,
  `<span class="who shadow">SHADOW:</span> Eu sinto o vazio se abrindo. Algo me chama do outro lado.`,
  `<span class="who titan">TITAN:</span> Você acha que pode escapar? Eu já marquei seu destino.`,
  `<span class="who mestre">MESTRE:</span> Não responda ao medo. Use-o. Transforme-o em lâmina.`,
  `<span class="who shadow">SHADOW:</span> Então... eu entro. E se eu cair, que as sombras me devorem.`,
  `<span class="who titan">TITAN:</span> Venha. Eu quero ouvir seu silêncio gritar.`
];

function sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }
function scrollToBottom(){ scrollLog.scrollTop = scrollLog.scrollHeight; }

function writeOut(html){
  const line = document.createElement("div");
  line.className = "outputLine";
  line.innerHTML = html;
  out.appendChild(line);
  scrollToBottom();
}
function finishTypingNow(){
  typing = false;
  cursor.style.display = "none";
  typeLine.innerHTML = loreLines.map(l => `<div class="typeLine">${l}</div>`).join("");
  const hasHint = out.textContent.includes("Digite ajuda");
  if(!hasHint){
    writeOut(`<span class="sys">SISTEMA:</span> Digite <b>ajuda</b> para ver comandos.`);
  }
}
async function startTyping(){
  if(typing) return;
  typing = true;
  typedOnce = true;

  typeLine.innerHTML = "";
  out.innerHTML = "";
  cursor.style.display = "inline-block";

  for(let i=0; i<loreLines.length; i++){
    if(!typing) break;

    const plain = loreLines[i].replace(/<[^>]*>/g, "");
    const holder = document.createElement("div");
    holder.className = "typeLine";
    typeLine.appendChild(holder);

    let acc = "";
    for(let c=0; c<plain.length; c++){
      if(!typing) break;
      acc += plain[c];
      holder.textContent = acc;
      scrollToBottom();
      await sleep(12 + Math.random()*18);
    }
    if(!typing) break;

    holder.innerHTML = loreLines[i];
    scrollToBottom();
    await sleep(220 + Math.random()*220);
  }

  if(typing){
    typing = false;
    cursor.style.display = "none";
    scrollToBottom();
    writeOut(`<span class="sys">SISTEMA:</span> Digite <b>ajuda</b> para ver comandos.`);
  }else{
    scrollToBottom();
  }
}

function openScroll(){
  if(!document.body.classList.contains("entered")) return;
  metricInc("m_scroll_opens");
  openOverlay("scrollOpen");
  setTimeout(()=>cmdInput.focus(), 80);
  if(!typedOnce) startTyping();
  else cursor.style.display = "none";
}
function closeScroll(){ closeOverlay("scrollOpen"); }

scrollBtn.addEventListener("click",(e)=>{
  e.stopPropagation();
  openScroll();
});
scrollClose.addEventListener("click", closeScroll);
scrollOverlay.addEventListener("click",(e)=>{
  if(e.target.classList.contains("dim")) closeScroll();
});

cmdInput.addEventListener("keydown", (e)=>{
  if(e.key !== "Enter") return;
  const raw = cmdInput.value.trim();
  if(!raw) return;
  cmdInput.value = "";

  if(typing) finishTypingNow();

  writeOut(`<span class="sys">VOCÊ:</span> ${escapeHtml(raw)}`);
  const cmd = raw.toLowerCase();

  if(cmd === "ajuda" || cmd === "help" || cmd === "?"){
    writeOut(`<span class="sys">COMANDOS:</span> <b>hub</b>, <b>arquivo</b>, <b>lore</b>, <b>fechar</b>`);
    return;
  }
  if(cmd === "fechar" || cmd === "close" || cmd === "exit"){
    writeOut(`<span class="sys">SISTEMA:</span> Pergaminho selado.`);
    setTimeout(closeScroll, 250);
    return;
  }
  if(cmd === "hub"){
    writeOut(`<span class="sys">SISTEMA:</span> Abrindo EDIT/HUB...`);
    setTimeout(openEditOverlay, 250);
    return;
  }
  if(cmd === "arquivo" || cmd === "archive"){
    writeOut(`<span class="sys">SISTEMA:</span> (placeholder) Abrindo ARQUIVO...`);
    return;
  }
  if(cmd === "lore"){
    writeOut(`<span class="sys">SISTEMA:</span> Você já ouviu as vozes... agora escolha um caminho.`);
    return;
  }

  writeOut(`<span class="sys">SISTEMA:</span> Comando desconhecido. Digite <b>ajuda</b>.`);
});

/* =========================
   ESC fecha qualquer overlay
   ========================= */
document.addEventListener("keydown",(e)=>{
  if(e.key !== "Escape") return;

  menuWrap.classList.remove("open");

  if(document.body.classList.contains("adminOpen")) return closeAdminOverlay();
  if(document.body.classList.contains("playlistsOpen")) return closePlaylistsOverlay();
  if(document.body.classList.contains("socialOpen")) return closeSocialOverlay();
  if(document.body.classList.contains("scrollOpen")) return closeScroll();
  if(document.body.classList.contains("editOpen")) return closeEditOverlay();
});

/* =========================
   MÉTRICAS
   ========================= */
metricInc("m_site_opens");
openSocial.addEventListener("click", ()=> metricInc("m_social_opens"), {capture:true});
openPlaylists.addEventListener("click", ()=> metricInc("m_playlists_opens"), {capture:true});
</script>

</body>
</html>
