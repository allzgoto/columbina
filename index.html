<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Shadow Temple Interface</title>

<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;700&family=Inter:wght@400;500&display=swap" rel="stylesheet" />

<style>
:root{
  --ink:#05060a;
  --coal:#0b0d12;
  --fog: rgba(10,12,16,.62);

  /* “tinta + sangue seco” (Shadow Fight vibes) */
  --bone: rgba(245,238,220,.86);
  --paper: rgba(20,18,16,.55);
  --paper2: rgba(10,8,7,.55);

  --red: rgba(200,60,60,.55);
  --red2: rgba(200,60,60,.18);

  --a: rgba(160,190,255,.22);   /* só um frio sutil */
  --a2: rgba(160,190,255,.10);
  --line: rgba(255,255,255,.07);

  --txt: rgba(245,248,255,.92);
  --dim: rgba(245,248,255,.62);

  --blur-amount: 26px;
}

*{margin:0;padding:0;box-sizing:border-box;}
body{
  background:var(--ink);
  overflow:hidden;
  color:var(--txt);
  font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
}

/* ========= VIDEO LAYERS ========= */
#videoBlur{
  position:fixed;
  inset:-20%;
  width:140%;
  height:140%;
  object-fit:cover;
  filter: blur(var(--blur-amount)) brightness(.46) saturate(1.02) contrast(1.06);
  transform: translateZ(0);
  z-index:-5;
}
#video{
  position:fixed;
  inset:0;
  width:100%;
  height:100%;
  object-fit:cover;
  z-index:-4;
  background:black;
}

/* ========= FX OVERLAYS ========= */
.scanlines{
  position:fixed;
  inset:0;
  background:repeating-linear-gradient(
    to bottom,
    rgba(255,255,255,0.02),
    rgba(255,255,255,0.02) 1px,
    transparent 1px,
    transparent 4px
  );
  pointer-events:none;
  z-index:3;
  mix-blend-mode:overlay;
  opacity:.42;
}

#cinemaFX{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:4;
}
#cinemaFX::before{
  content:"";
  position:absolute;
  inset:-20%;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='180' height='180'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='.9' numOctaves='2' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)' opacity='.35'/%3E%3C/svg%3E");
  opacity:.07;
  mix-blend-mode:overlay;
  animation:grain 6s steps(10) infinite;
}
#cinemaFX::after{
  content:"";
  position:absolute;
  inset:0;
  /* vinheta “ink” (sem blush) */
  background:
    radial-gradient(circle at 50% 48%, transparent 0 62%, rgba(0,0,0,.48) 82%, rgba(0,0,0,.78) 100%),
    radial-gradient(circle at 55% 55%, rgba(200,60,60,.04), transparent 55%);
  opacity:.66;
}
@keyframes grain{
  0%{transform:translate(0,0)}
  10%{transform:translate(-2%, -3%)}
  20%{transform:translate(-4%, 2%)}
  30%{transform:translate(3%, -2%)}
  40%{transform:translate(2%, 4%)}
  50%{transform:translate(-3%, 2%)}
  60%{transform:translate(4%, 0%)}
  70%{transform:translate(0%, 3%)}
  80%{transform:translate(-2%, -2%)}
  90%{transform:translate(3%, 1%)}
  100%{transform:translate(0,0)}
}

/* Flash de ruptura */
#glitchFlash{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:9;
  opacity:0;
  background:
    radial-gradient(circle at 50% 50%, rgba(255,255,255,.10), transparent 55%),
    radial-gradient(circle at 50% 55%, rgba(200,60,60,.10), transparent 55%),
    repeating-linear-gradient(0deg, rgba(255,255,255,.05) 0 1px, transparent 1px 5px);
  mix-blend-mode:screen;
}
.glitch-on #glitchFlash{ animation:glitchFlash .55s steps(6) 1; }
@keyframes glitchFlash{
  0%{opacity:0}
  10%{opacity:1; transform:translateX(6px)}
  25%{opacity:.28; transform:translateX(-8px)}
  40%{opacity:1; transform:translateX(4px)}
  60%{opacity:.18; transform:translateX(-4px)}
  80%{opacity:.85; transform:translateX(2px)}
  100%{opacity:0; transform:none}
}

/* ========= LOADING ========= */
#loadingScreen{
  position:fixed;
  inset:0;
  background:radial-gradient(circle at center,#090a0e,#000);
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:10;
  transition:opacity .6s ease;
  overflow:hidden;
}
.loading-text{
  letter-spacing:6px;
  margin-bottom:20px;
  font-size:11px;
  opacity:.82;
  text-align:center;
  animation:flicker 2.2s infinite;
  max-width:90vw;
  font-family:Cinzel, serif;
}
@keyframes flicker{0%,100%{opacity:.78}50%{opacity:1}}
.spinner{
  width:40px;height:40px;
  border:3px solid rgba(255,255,255,.08);
  border-top:3px solid rgba(200,60,60,.55);
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{to{transform:rotate(360deg)}}

#enterBox{
  margin-top:34px;
  padding:18px 70px;
  border-radius:12px;
  background:rgba(10,8,7,0.62);
  border:1px solid rgba(200,60,60,0.28);
  backdrop-filter:blur(14px);
  letter-spacing:8px;
  font-weight:700;
  font-size:13px;
  color:rgba(245,238,220,.92);
  text-shadow:0 0 16px rgba(200,60,60,.10);
  opacity:0;
  pointer-events:none;
  transition:.4s ease;
  cursor:pointer;
  user-select:none;
  font-family:Cinzel, serif;
  position:relative;
  overflow:hidden;
}
#enterBox::before{
  content:"";
  position:absolute;
  inset:-40% -30%;
  background:linear-gradient(90deg, transparent, rgba(245,238,220,.10), transparent);
  transform:rotate(14deg) translateX(-90%);
  opacity:.0;
}
#enterBox.show{opacity:1; pointer-events:auto;}
#enterBox.show::before{
  opacity:.6;
  animation:scanPass 1.2s ease infinite;
}
@keyframes scanPass{
  0%{transform:rotate(14deg) translateX(-90%);}
  100%{transform:rotate(14deg) translateX(90%);}
}

#enterHint{
  margin-top:12px;
  font-size:9px;
  letter-spacing:4px;
  opacity:0;
  transition:.35s ease;
  color:rgba(245,238,220,.70);
  text-shadow:0 0 14px rgba(200,60,60,.08);
  user-select:none;
}
#enterHint.show{opacity:.88;}

#enterScan{
  position:absolute;
  inset:0;
  pointer-events:none;
  opacity:0;
  z-index:0;
}
#enterScan::before{
  content:"";
  position:absolute;
  left:-40%;
  top:0;
  width:45%;
  height:100%;
  background:linear-gradient(90deg, transparent, rgba(200,60,60,.10), rgba(245,238,220,.12), rgba(200,60,60,.10), transparent);
  transform:skewX(-14deg) translateX(-120%);
  filter: blur(1px);
}
#loadingScreen.scan-on #enterScan{ opacity:1; }
#loadingScreen.scan-on #enterScan::before{ animation: enterScanPass .85s ease 1; }
@keyframes enterScanPass{
  0%{transform:skewX(-14deg) translateX(-120%); opacity:0}
  15%{opacity:1}
  100%{transform:skewX(-14deg) translateX(380%); opacity:0}
}

#enterFooterLeft{
  position:fixed;
  left:18px;
  bottom:12px;
  z-index:11;
  font-size:9px;
  letter-spacing:3px;
  opacity:.30;
  user-select:none;
  text-shadow:0 0 12px rgba(200,60,60,.05);
  font-family:Cinzel, serif;
}
body.entered #enterFooterLeft{ display:none; }

#versionTag{
  position:fixed;
  right:18px;
  bottom:12px;
  z-index:6;
  font-size:9px;
  letter-spacing:3px;
  opacity:.30;
  user-select:none;
  text-shadow:0 0 12px rgba(0,0,0,.35);
  font-family:Cinzel, serif;
}
#versionTag .v{opacity:.88;color:rgba(245,238,220,.70);}
#loadingScreen #versionTag{ z-index:12; }

/* ========= HUD SHADOW-FIGHT (pergaminho/ink) ========= */
.hudPanel{
  border:1px solid rgba(245,238,220,.10);
  background:
    radial-gradient(circle at 18% 12%, rgba(245,238,220,.08), transparent 55%),
    linear-gradient(180deg, rgba(10,8,7,.58), rgba(0,0,0,.38));
  box-shadow:
    0 18px 58px rgba(0,0,0,.55),
    0 0 0 1px rgba(0,0,0,.30) inset;
  backdrop-filter: blur(14px);
  position:relative;
  overflow:hidden;
}
.hudPanel::before{
  content:"";
  position:absolute;
  inset:-2px;
  pointer-events:none;
  background:
    radial-gradient(circle at 20% 15%, rgba(200,60,60,.10), transparent 55%),
    radial-gradient(circle at 80% 80%, rgba(255,255,255,.04), transparent 55%);
  mix-blend-mode:overlay;
  opacity:.6;
}
.hudPanel::after{
  content:"";
  position:absolute;
  inset:0;
  pointer-events:none;
  background:
    repeating-linear-gradient(0deg, rgba(255,255,255,.03) 0 1px, transparent 1px 6px);
  opacity:.35;
  mix-blend-mode:overlay;
}

/* coords HUD */
#coordsHUD{
  position:fixed;
  top:16px;
  right:18px;
  z-index:6;
  padding:10px 12px;
  border-radius:14px;
  font-size:9px;
  letter-spacing:3px;
  opacity:.78;
  user-select:none;
  font-family:Cinzel, serif;
}
#coordsHUD{ border-left:2px solid rgba(200,60,60,.18); }
#coordsHUD .line{opacity:.86}
#coordsHUD .blink{animation:coordsBlink 3.2s infinite}
@keyframes coordsBlink{0%,100%{opacity:.75}50%{opacity:.28}}

/* tech HUD vira “RITOS” (menos tech, mais placa) */
#techHUD{
  position:fixed;
  top:78px;
  left:18px;
  z-index:6;
  width:min(360px, 44vw);
  padding:10px 12px;
  border-radius:14px;
  font-size:9px;
  letter-spacing:3px;
  opacity:.70;
  user-select:none;
  line-height:1.65;
  font-family:Cinzel, serif;
}
#techHUD{ border-left:2px solid rgba(200,60,60,.16); }
#techHUD .tag{opacity:.78}
#techHUD .value{opacity:.92; color:rgba(245,238,220,.86)}
#techHUD .sep{opacity:.22}

/* Status strip vira “marcas” */
#statusStrip{
  position:fixed;
  left:18px;
  top:198px;
  width:min(230px, 34vw);
  z-index:6;
  opacity:.72;
  user-select:none;
  pointer-events:none;
  font-size:9px;
  letter-spacing:2px;
  line-height:1.45;
  font-family:Cinzel, serif;
}
#statusStrip .statusLine{
  display:flex;
  gap:8px;
  align-items:baseline;
  padding:7px 10px;
  border-radius:14px;
  margin-bottom:8px;
}
#statusStrip .statusLine{
  background:
    linear-gradient(180deg, rgba(10,8,7,.62), rgba(0,0,0,.35));
  border:1px solid rgba(245,238,220,.08);
  border-left:2px solid rgba(200,60,60,.14);
  box-shadow: 0 14px 44px rgba(0,0,0,.45);
}
#statusStrip .k{opacity:.70}
#statusStrip .v{opacity:.92; color:rgba(245,238,220,.82)}
#statusStrip .faint{opacity:.55}
@media (max-width: 768px){ #statusStrip{display:none;} }

/* ✅ Só na tela ENTER */
body.entered #coordsHUD,
body.entered #techHUD{ display:none; }

/* ========= TOP CONTROLS (INK ICONS) ========= */
#topControls{
  position:fixed;
  top:14px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:10px;
  z-index:25;
  opacity:.95;
  transition:.18s ease;
}
#topControls:hover{opacity:1}

.ctrlBtn{
  width:46px;height:38px;
  border-radius:14px;
  border:1px solid rgba(245,238,220,.10);
  background:
    radial-gradient(circle at 30% 30%, rgba(245,238,220,.06), transparent 58%),
    linear-gradient(180deg, rgba(10,8,7,.66), rgba(0,0,0,.46));
  backdrop-filter: blur(14px);
  cursor:pointer;
  display:grid;
  place-items:center;
  box-shadow:
    0 0 0 1px rgba(0,0,0,.32) inset,
    0 18px 54px rgba(0,0,0,.50);
  position:relative;
  overflow:hidden;
  color:rgba(245,238,220,.92);
}
.ctrlBtn::before{
  content:"";
  position:absolute;
  inset:2px;
  border-radius:12px;
  border:1px solid rgba(255,255,255,.04);
  pointer-events:none;
}
.ctrlBtn::after{
  content:"";
  position:absolute;
  inset:-40% -30%;
  background:linear-gradient(90deg, transparent, rgba(200,60,60,.10), transparent);
  transform:rotate(16deg) translateX(-90%);
  opacity:0;
  pointer-events:none;
}
#topControls:hover .ctrlBtn::after{
  opacity:1;
  animation:scanPass2 1.25s ease infinite;
}
@keyframes scanPass2{
  0%{transform:rotate(16deg) translateX(-90%);}
  100%{transform:rotate(16deg) translateX(90%);}
}
.ctrlBtn:hover{
  transform: translateY(-1px);
  box-shadow:
    0 0 0 1px rgba(0,0,0,.32) inset,
    0 22px 62px rgba(0,0,0,.60),
    0 0 24px rgba(200,60,60,.07);
}
.ctrlBtn:active{transform:translateY(1px)}
.ctrlBtn svg{
  width:20px;height:20px;
  opacity:.92;
  filter: url(#ink) drop-shadow(0 0 10px rgba(0,0,0,.35));
}

/* ========= SOCIAL CONTROL (SELOS) ========= */
#socialControl{
  position:fixed;
  top:12px;
  right:14px;
  z-index:26;
  opacity:.95;
  transition:.18s ease;
}
#socialControl:hover{opacity:1}

.linkPill{
  height:38px;
  padding:0 12px;
  border-radius:999px;
  border:1px solid rgba(245,238,220,.10);
  background:
    radial-gradient(circle at 30% 30%, rgba(245,238,220,.06), transparent 60%),
    linear-gradient(180deg, rgba(10,8,7,.62), rgba(0,0,0,.40));
  backdrop-filter: blur(14px);
  cursor:pointer;
  display:flex;
  align-items:center;
  gap:8px;
  color:rgba(245,238,220,.90);
  letter-spacing:4px;
  font-size:9px;
  box-shadow:
    0 0 0 1px rgba(255,255,255,.03) inset,
    0 16px 50px rgba(0,0,0,.46);
  position:relative;
  font-family:Cinzel, serif;
}
.linkPill svg{
  width:18px;height:18px;
  opacity:.92;
  filter: url(#ink) drop-shadow(0 0 10px rgba(0,0,0,.35));
}
.linkPill:hover{
  transform: translateY(-1px);
  box-shadow:
    0 0 0 1px rgba(255,255,255,.04) inset,
    0 20px 62px rgba(0,0,0,.56),
    0 0 18px rgba(200,60,60,.06);
}
.linkPill:active{transform:translateY(1px);}
@media (max-width: 520px){
  .linkPill span{display:none;}
  .linkPill{padding:0 10px;}
}

/* ========= ROUTES NODE (SELOS) — ritual open ========= */
#routesNode{
  position:fixed;
  top:54px;
  right:14px;
  z-index:40;
  display:none;
  pointer-events:none;
}
#routesNode.show{
  display:block;
  pointer-events:auto;
}

.routesBox{
  width:78px;
  padding:10px 8px;
  border-radius:18px;
  border:1px solid rgba(245,238,220,.10);
  background:
    radial-gradient(circle at 35% 20%, rgba(245,238,220,.06), transparent 62%),
    linear-gradient(180deg, rgba(10,8,7,.68), rgba(0,0,0,.42));
  backdrop-filter: blur(14px);
  box-shadow:0 22px 70px rgba(0,0,0,.62);
  display:flex;
  flex-direction:column;
  gap:10px;
  position:relative;
  overflow:visible;
}

/* anel rúnico + fumaça atrás */
.routesBox .sigilRing{
  position:absolute;
  inset:-22px -22px auto auto;
  width:130px;
  height:130px;
  pointer-events:none;
  opacity:0;
  transform: translate(14px,-10px) scale(.92);
  filter: drop-shadow(0 0 26px rgba(0,0,0,.55));
}
#routesNode.show .routesBox .sigilRing{
  opacity:1;
  animation: sigilIn .38s ease forwards;
}
@keyframes sigilIn{
  from{opacity:0; transform: translate(18px,-14px) scale(.88) rotate(-8deg);}
  to{opacity:1; transform: translate(14px,-10px) scale(.92) rotate(0deg);}
}
.sigilRing .ring{
  transform-origin: 50% 50%;
  animation: ringRotate 5.2s linear infinite;
  opacity:.78;
}
.sigilRing .runes{
  transform-origin: 50% 50%;
  animation: ringRotate2 8.6s linear infinite reverse;
  opacity:.58;
}
@keyframes ringRotate{to{transform:rotate(360deg)}}
@keyframes ringRotate2{to{transform:rotate(360deg)}}

.routesBox::before{
  content:"";
  position:absolute;
  inset:-24px -24px -24px -24px;
  pointer-events:none;
  background:
    radial-gradient(circle at 82% 8%, rgba(200,60,60,.12), transparent 42%),
    radial-gradient(circle at 86% 18%, rgba(245,238,220,.10), transparent 48%),
    radial-gradient(circle at 90% 10%, rgba(0,0,0,.55), transparent 55%);
  opacity:.0;
}
#routesNode.show .routesBox::before{
  opacity:1;
  animation: smokeBloom .62s ease forwards;
}
@keyframes smokeBloom{
  0%{transform:scale(.98); filter: blur(10px); opacity:0}
  45%{opacity:.85}
  100%{transform:scale(1.0); filter: blur(16px); opacity:.55}
}

.routeBtn{
  width:58px;
  height:58px;
  border-radius:18px;
  border:1px solid rgba(245,238,220,.10);
  background:
    radial-gradient(circle at 30% 30%, rgba(245,238,220,.05), transparent 64%),
    linear-gradient(180deg, rgba(0,0,0,.12), rgba(0,0,0,.34));
  box-shadow:
    0 0 0 1px rgba(0,0,0,.34) inset,
    0 14px 40px rgba(0,0,0,.38);
  display:grid;
  place-items:center;
  cursor:pointer;
  position:relative;
  opacity:0;
  transform:translateY(-10px) scale(.96);
  overflow:hidden;
}
.routeBtn::after{
  content:"";
  position:absolute;
  inset:-40% -30%;
  background:linear-gradient(90deg, transparent, rgba(200,60,60,.10), transparent);
  transform:rotate(14deg) translateX(-90%);
  opacity:0;
}
.routeBtn:hover::after{
  opacity:.9;
  animation:scanPass2 1.25s ease infinite;
}
.routeBtn:hover{
  border-color: rgba(200,60,60,.18);
  box-shadow:
    0 0 0 1px rgba(0,0,0,.34) inset,
    0 18px 52px rgba(0,0,0,.52),
    0 0 22px rgba(200,60,60,.08);
  transform: translateY(-1px);
}

#routesNode.show .routeBtn{ animation: sealPop .22s ease forwards; }
#routesNode.show .routeBtn:nth-child(2){animation-delay:.06s}
#routesNode.show .routeBtn:nth-child(3){animation-delay:.12s}
#routesNode.show .routeBtn:nth-child(4){animation-delay:.18s}
@keyframes sealPop{
  0%{opacity:0; transform:translateY(-10px) scale(.94); filter: blur(.6px);}
  70%{opacity:1; transform:translateY(1px) scale(1.02); filter:none;}
  100%{opacity:1; transform:translateY(0) scale(1.0);}
}

.routeIcon svg{
  width:18px;height:18px;
  opacity:.92;
  filter: url(#ink) drop-shadow(0 0 10px rgba(0,0,0,.35));
}
.routeTip{
  position:absolute;
  right: calc(100% + 10px);
  top:50%;
  transform:translateY(-50%) translateX(10px);
  opacity:0;
  pointer-events:none;
  transition:.18s ease;
  padding:10px 12px;
  border-radius:14px;
  border:1px solid rgba(245,238,220,.10);
  background:rgba(0,0,0,.46);
  backdrop-filter: blur(12px);
  box-shadow:0 18px 58px rgba(0,0,0,.55);
  white-space:nowrap;
  min-width: 170px;
  font-family:Cinzel, serif;
}
.routeTip .t{
  display:block;
  font-size:9px;
  letter-spacing:4px;
  color:rgba(245,238,220,.90);
  text-shadow:0 0 10px rgba(0,0,0,.45);
}
.routeTip .s{
  display:block;
  margin-top:3px;
  font-size:8px;
  letter-spacing:2px;
  color:rgba(245,238,220,.70);
}
.routeBtn:hover .routeTip{
  opacity:1;
  transform:translateY(-50%) translateX(0);
}

/* ========= VOLUME (ECO) — estilo “placa” ========= */
#volumeHUD{
  position:fixed;
  top:18px;
  left:18px;
  display:flex;
  align-items:flex-start;
  gap:12px;
  z-index:20;
  opacity:.78;
  transition:.25s ease;
}
#volumeHUD:hover{ opacity:1; }

.vol-btn{
  position:relative;
  width:44px;height:44px;
  border-radius:14px;
  border:1px solid rgba(245,238,220,.10);
  background:linear-gradient(180deg, rgba(10,8,7,.68), rgba(0,0,0,.52));
  backdrop-filter: blur(14px);
  display:grid;
  place-items:center;
  cursor:pointer;
  padding:0;
  box-shadow:
    0 0 0 1px rgba(0,0,0,.34) inset,
    0 18px 54px rgba(0,0,0,.52);
  overflow:hidden;
}
.vol-btn::after{
  content:"";
  position:absolute;
  inset:-40% -30%;
  background:linear-gradient(90deg, transparent, rgba(200,60,60,.10), transparent);
  transform:rotate(16deg) translateX(-90%);
  opacity:0;
}
#volumeHUD:hover .vol-btn::after{
  opacity:.7;
  animation:scanPass2 1.25s ease infinite;
}
.vol-svg{width:22px;height:22px;opacity:.92;filter:url(#ink) drop-shadow(0 0 10px rgba(0,0,0,.35));}
.vol-state{
  position:absolute;
  left:50%; bottom:-10px;
  transform:translateX(-50%);
  font-size:8px;
  letter-spacing:2px;
  padding:2px 7px;
  border-radius:999px;
  border:1px solid rgba(200,60,60,.28);
  background:rgba(0,0,0,.45);
  color:rgba(245,238,220,.88);
  display:none;
  font-family:Cinzel, serif;
}

.vol-panel{
  width:0;
  opacity:0;
  pointer-events:none;
  transform:translateY(-2px);
  transition:.25s ease;
  padding:10px 0;
  border-radius:14px;
  border:1px solid rgba(245,238,220,.10);
  background:
    linear-gradient(180deg, rgba(10,8,7,.78), rgba(0,0,0,.62)),
    repeating-linear-gradient(90deg, rgba(255,255,255,.03) 0 1px, transparent 1px 12px);
  backdrop-filter: blur(14px);
  box-shadow: 0 18px 62px rgba(0,0,0,.62);
  overflow:hidden;
  font-family:Cinzel, serif;
}
#volumeHUD:hover .vol-panel,
#volumeHUD.open .vol-panel{
  width:240px;
  opacity:1;
  pointer-events:auto;
  padding:10px 12px;
}
.vol-top{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px;}
.vol-title{font-size:9px;letter-spacing:3px;opacity:.72;color:rgba(245,238,220,.72);}
.vol-readout{font-size:10px;letter-spacing:2px;color:rgba(245,238,220,.90);text-shadow:0 0 10px rgba(0,0,0,.45);}

#volSlider{
  width:100%;
  height:26px;
  background:transparent;
  appearance:none;
  -webkit-appearance:none;
  cursor:pointer;
}
#volSlider::-webkit-slider-runnable-track{
  height:6px;border-radius:999px;
  background:
    linear-gradient(90deg, rgba(245,238,220,.78), rgba(200,60,60,.18)),
    repeating-linear-gradient(90deg, rgba(255,255,255,.08) 0 1px, transparent 1px 10px);
  border:1px solid rgba(245,238,220,.10);
}
#volSlider::-webkit-slider-thumb{
  -webkit-appearance:none;
  width:16px;height:16px;border-radius:7px;
  margin-top:-6px;
  background: radial-gradient(circle at 30% 30%, rgba(245,238,220,1), rgba(200,60,60,.18));
  border:1px solid rgba(245,238,220,.14);
  box-shadow:0 0 14px rgba(0,0,0,.35);
}
#volSlider::-moz-range-track{
  height:6px;border-radius:999px;
  background:
    linear-gradient(90deg, rgba(245,238,220,.78), rgba(200,60,60,.18)),
    repeating-linear-gradient(90deg, rgba(255,255,255,.08) 0 1px, transparent 1px 10px);
  border:1px solid rgba(245,238,220,.10);
}
#volSlider::-moz-range-thumb{
  width:16px;height:16px;border-radius:7px;
  background: radial-gradient(circle at 30% 30%, rgba(245,238,220,1), rgba(200,60,60,.18));
  border:1px solid rgba(245,238,220,.14);
  box-shadow:0 0 14px rgba(0,0,0,.35);
}
.vol-footer{
  margin-top:8px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  font-size:9px;
  letter-spacing:3px;
  opacity:.62;
  color:rgba(245,238,220,.72);
}
.vol-bars{
  width:70px;
  height:10px;
  border-radius:6px;
  background:repeating-linear-gradient(90deg, rgba(245,238,220,var(--bars-a,.55)) 0 6px, transparent 6px 10px);
  clip-path: inset(0 calc(100% - var(--bars-w,50%)) 0 0 round 6px);
  transition: clip-path .08s linear;
}

/* ========= MODAIS (terminal/catalog/channels/admin/games) ========= */
/* Mantive suas estruturas — só padronizei o “mood” com bordas/osso */
#terminal,#catalog,#channels,#admin,#gamesPanel{
  position:fixed;
  inset:0;
  display:none;
  backdrop-filter: blur(14px);
}
#terminal.show,#catalog.show,#channels.show,#admin.show,#gamesPanel.show{display:block;}
#terminal{z-index:30;background:rgba(0,0,0,.62);}
#catalog{z-index:29;background:rgba(0,0,0,.60);}
#channels{z-index:28;background:rgba(0,0,0,.56);}
#admin{z-index:27;background:rgba(0,0,0,.60);}
#gamesPanel{z-index:31;background:rgba(0,0,0,.60);}

/* (o resto do seu CSS dos painéis pode ficar como estava,
   mas como você pediu 1/4/5, o impacto maior é: HUD+ícones+node ritual.
   Na Parte 2 eu mantenho o HTML completo e na 3 o JS completo.) */

/* reduced motion */
@media (prefers-reduced-motion: reduce){
  .spinner{animation:none}
  #cinemaFX::before{animation:none}
  #topControls .ctrlBtn::after{animation:none; opacity:0;}
  #loadingScreen.scan-on #enterScan::before{animation:none !important;}
  #routesNode.show .routeBtn{animation:none; opacity:1; transform:none;}
  .sigilRing .ring,.sigilRing .runes{animation:none}
}
@media (max-width: 768px){
  :root{ --blur-amount: 22px; }
  #techHUD{display:none;}
}
</style>
</head>
<body>

<!-- SVG defs: filtro INK pros ícones ficarem “brush / Shadow Fight” -->
<svg width="0" height="0" style="position:absolute">
  <defs>
    <filter id="ink">
      <feTurbulence type="fractalNoise" baseFrequency="0.9" numOctaves="2" seed="2" result="noise"/>
      <feDisplacementMap in="SourceGraphic" in2="noise" scale="0.8" xChannelSelector="R" yChannelSelector="G"/>
    </filter>
  </defs>
</svg>

<!-- VÍDEO -->
<video id="videoBlur" playsinline preload="auto" muted loop>
  <source src="https://files.catbox.moe/klaol5.webm" type="video/webm" />
</video>
<video id="video" playsinline preload="auto" loop>
  <source src="https://files.catbox.moe/klaol5.webm" type="video/webm" />
</video>

<!-- ÁUDIO -->
<audio id="ambience" preload="auto" loop>
  <source src="https://files.catbox.moe/99fu05.m4a" type="audio/mp4">
</audio>

<div class="scanlines"></div>
<div id="cinemaFX"></div>
<div id="glitchFlash"></div>

<div id="versionTag"><span class="v">shadow temple interface: v2 (ink)</span></div>

<div id="loadingScreen">
  <div id="enterScan" aria-hidden="true"></div>
  <div class="loading-text" id="dynamicText">O TEMPLO OBSERVA…</div>
  <div class="spinner" id="spinner"></div>

  <div id="enterBox">ENTRAR</div>
  <div id="enterHint">PRESSIONE [ENTER] PARA PROSSEGUIR</div>

  <div id="enterFooterLeft">SELO ATIVO // PASSO PROIBIDO</div>
</div>

<!-- HUDs (somente na tela ENTER) -->
<div id="coordsHUD" class="hudPanel">
  <div class="line blink" id="coordA">SELO: — — —</div>
  <div class="line" id="coordB">PORTAL: LATENTE // VIGIA: PRESENTE</div>
</div>

<div id="techHUD" class="hudPanel">
  <div class="termLine"><span class="tag">RITO</span> <span class="sep">//</span> <span class="value" id="sysClock">--:--:--</span></div>
  <div class="termLine"><span class="tag">PORTAL</span> <span class="sep">//</span> <span class="value" id="sysStream">DORMENTE</span></div>
  <div class="termLine"><span class="tag">ECO</span> <span class="sep">//</span> <span class="value" id="sysNeural">SILÊNCIO</span></div>
  <div class="termLine"><span class="tag">VOTO</span> <span class="sep">//</span> <span class="value">IRRELEVANTE</span></div>
  <div class="termLine"><span class="tag">VISITANTE</span> <span class="sep">//</span> <span class="value" id="sysSubject">À PORTA</span></div>

  <div class="termLine"><span class="tag">FASE</span> <span class="sep">//</span> <span class="value" id="sysPhase">DESPERTAR</span></div>
  <div class="termLine"><span class="tag">JURAMENTO</span> <span class="sep">//</span> <span class="value" id="sysDirective">OBSERVAR</span></div>
</div>

<div id="statusStrip">
  <div class="statusLine" id="ss1"><span class="k">TEMPLO</span> <span class="v">IMÓVEL</span></div>
  <div class="statusLine faint" id="ss2"><span class="k">PORTAL</span> <span class="v">LATENTE</span></div>
  <div class="statusLine faint" id="ss3"><span class="k">ECO</span> <span class="v">—</span></div>
</div>

<!-- TOP CONTROLS (ícones “ink/brush”) -->
<div id="topControls">
  <button class="ctrlBtn" id="btnFS" title="Ritual: Tela Cheia" aria-label="Tela cheia">
    <!-- “portal frame” mais agressivo -->
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M7 3H5a2 2 0 0 0-2 2v2M17 3h2a2 2 0 0 1 2 2v2M7 21H5a2 2 0 0 1-2-2v-2M17 21h2a2 2 0 0 0 2-2v-2"
        fill="none" stroke="rgba(245,238,220,.90)" stroke-width="2.2" stroke-linecap="round"/>
      <path d="M9 7h6M9 17h6" fill="none" stroke="rgba(200,60,60,.35)" stroke-width="1.6" stroke-linecap="round"/>
    </svg>
  </button>

  <button class="ctrlBtn" id="btnCat" title="Arquivos" aria-label="Arquivos">
    <!-- “scroll blade” -->
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M6 5h10v14H8.6a3 3 0 0 1 0-6H16" fill="none" stroke="rgba(245,238,220,.88)" stroke-width="2.0" stroke-linejoin="round"/>
      <path d="M9.8 10h4.8M9.8 13h4.6M9.8 16h3.6" fill="none" stroke="rgba(245,238,220,.70)" stroke-width="2.0" stroke-linecap="round"/>
    </svg>
  </button>

  <button class="ctrlBtn" id="btnTerm" title="Grimório" aria-label="Grimório">
    <!-- “sigil” -->
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 3.8c4.8 0 8.4 3.2 8.4 8.2S16.8 20.2 12 20.2 3.6 17 3.6 12 7.2 3.8 12 3.8Z"
        fill="none" stroke="rgba(245,238,220,.86)" stroke-width="2.0" stroke-linejoin="round"/>
      <path d="M12 7.2v9.6M7.2 12h9.6" fill="none" stroke="rgba(200,60,60,.30)" stroke-width="1.8" stroke-linecap="round"/>
      <path d="M8.3 8.3l7.4 7.4M15.7 8.3l-7.4 7.4" fill="none" stroke="rgba(245,238,220,.45)" stroke-width="1.4" stroke-linecap="round"/>
    </svg>
  </button>

  <button class="ctrlBtn" id="btnAdmin" title="Câmara Secreta" aria-label="Câmara secreta">
    <!-- “mask ink” -->
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 3c5 0 8.5 2.9 8.5 7.9 0 7.3-5.6 10.9-8.5 10.9S3.5 18.2 3.5 10.9C3.5 5.9 7 3 12 3Z"
        fill="none" stroke="rgba(245,238,220,.88)" stroke-width="2.0" stroke-linejoin="round"/>
      <path d="M8.6 11c1.0-1.3 2.5-1.0 3.6 0m2.6 0c1.0-1.3 2.5-1.0 3.6 0"
        fill="none" stroke="rgba(245,238,220,.62)" stroke-width="2.0" stroke-linecap="round"/>
      <path d="M9 15.2c1.1.9 2.1 1.0 3 1.0s1.9-.1 3-1.0"
        fill="none" stroke="rgba(200,60,60,.26)" stroke-width="1.9" stroke-linecap="round"/>
    </svg>
  </button>
</div>

<!-- Social / Seals control -->
<div id="socialControl" aria-label="Selos">
  <button class="linkPill" id="btnLinks" type="button" title="SELOS" aria-label="Abrir selos">
    <!-- “seal knot” -->
    <svg viewBox="0 0 24 24" aria-hidden="true">
      <path d="M9 14.5 7.2 16.3a3.2 3.2 0 1 1-4.5-4.5L4.6 10a3.2 3.2 0 0 1 4.5 0"
        fill="none" stroke="rgba(245,238,220,.86)" stroke-width="2.1" stroke-linecap="round"/>
      <path d="M15 9.5 16.8 7.7a3.2 3.2 0 0 1 4.5 4.5L19.4 14a3.2 3.2 0 0 1-4.5 0"
        fill="none" stroke="rgba(245,238,220,.70)" stroke-width="2.1" stroke-linecap="round"/>
      <path d="M8.8 15.2 15.2 8.8"
        fill="none" stroke="rgba(200,60,60,.28)" stroke-width="2.0" stroke-linecap="round"/>
    </svg>
    <span>SELOS</span>
  </button>
</div>

<!-- ROUTES NODE -->
<div id="routesNode" aria-hidden="true">
  <div class="routesBox" role="navigation" aria-label="Selos externos">
    <!-- sigil ring -->
    <svg class="sigilRing" viewBox="0 0 120 120" aria-hidden="true">
      <g class="ring">
        <circle cx="60" cy="60" r="46" fill="none" stroke="rgba(245,238,220,.26)" stroke-width="2.2"/>
        <circle cx="60" cy="60" r="38" fill="none" stroke="rgba(200,60,60,.18)" stroke-width="1.6" stroke-dasharray="2 6"/>
      </g>
      <g class="runes">
        <path d="M60 16 L63 24 L60 20 L57 24 Z" fill="rgba(245,238,220,.38)"/>
        <path d="M60 104 L63 96 L60 100 L57 96 Z" fill="rgba(245,238,220,.38)"/>
        <path d="M16 60 L24 63 L20 60 L24 57 Z" fill="rgba(245,238,220,.34)"/>
        <path d="M104 60 L96 63 L100 60 L96 57 Z" fill="rgba(245,238,220,.34)"/>
        <circle cx="60" cy="60" r="14" fill="none" stroke="rgba(245,238,220,.18)" stroke-width="1.4"/>
      </g>
    </svg>

    <button class="routeBtn" id="rSocial" type="button" aria-label="Selos sociais" data-title="SELOS SOCIAIS" data-sub="Discord / Instagram">
      <span class="routeIcon" aria-hidden="true">
        <!-- “sigil hex” -->
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 3.6 19.2 8v8L12 20.4 4.8 16V8L12 3.6Z" fill="none" stroke="rgba(245,238,220,.82)" stroke-width="2.0" stroke-linejoin="round"/>
          <path d="M12 7.2v9.6M8.7 10.5 12 12.2l3.3-1.7" fill="none" stroke="rgba(200,60,60,.24)" stroke-width="1.8" stroke-linecap="round"/>
        </svg>
      </span>
      <span class="routeTip" aria-hidden="true"><span class="t">SELOS SOCIAIS</span><span class="s">Discord / Instagram</span></span>
    </button>

    <button class="routeBtn" id="rGames" type="button" aria-label="Arena" data-title="ARENA" data-sub="Vitrine / hub">
      <span class="routeIcon" aria-hidden="true">
        <!-- “katana” -->
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M4 20l6-2 10-10-4-4L6 14l-2 6Z" fill="none" stroke="rgba(245,238,220,.82)" stroke-width="2.0" stroke-linejoin="round"/>
          <path d="M13.6 6.4l4 4" fill="none" stroke="rgba(200,60,60,.24)" stroke-width="1.8" stroke-linecap="round"/>
        </svg>
      </span>
      <span class="routeTip" aria-hidden="true"><span class="t">ARENA</span><span class="s">Vitrine / hub</span></span>
    </button>

    <button class="routeBtn" id="rArchive" type="button" aria-label="Arquivo" data-title="ARQUIVO" data-sub="Imagens / memórias">
      <span class="routeIcon" aria-hidden="true">
        <!-- “coffin” -->
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M6 7h12v4H6V7Z" fill="none" stroke="rgba(245,238,220,.82)" stroke-width="2.0" stroke-linejoin="round"/>
          <path d="M7 11v9h10v-9" fill="none" stroke="rgba(245,238,220,.62)" stroke-width="2.0" stroke-linejoin="round"/>
          <path d="M10 15h4" fill="none" stroke="rgba(200,60,60,.22)" stroke-width="1.8" stroke-linecap="round"/>
        </svg>
      </span>
      <span class="routeTip" aria-hidden="true"><span class="t">ARQUIVO</span><span class="s">Imagens / memórias</span></span>
    </button>

    <button class="routeBtn" id="rTx" type="button" aria-label="Eco" data-title="ECO" data-sub="Presença sonora">
      <span class="routeIcon" aria-hidden="true">
        <!-- “echo” -->
        <svg viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 4v16" fill="none" stroke="rgba(245,238,220,.82)" stroke-width="2.0" stroke-linecap="round"/>
          <path d="M8 8a6 6 0 0 0 0 8" fill="none" stroke="rgba(245,238,220,.62)" stroke-width="2.0" stroke-linecap="round"/>
          <path d="M16 8a6 6 0 0 1 0 8" fill="none" stroke="rgba(200,60,60,.20)" stroke-width="1.8" stroke-linecap="round"/>
        </svg>
      </span>
      <span class="routeTip" aria-hidden="true"><span class="t">ECO</span><span class="s">Presença sonora</span></span>
    </button>
  </div>
</div>

<!-- VOLUME -->
<div id="volumeHUD" class="vol" aria-label="Controle de eco" style="--bars-w:50%; --bars-a:.55;">
  <button id="volIconBtn" class="vol-btn" type="button" aria-label="Abrir controle de eco">
    <!-- “gong / bell” -->
    <svg class="vol-svg" viewBox="0 0 24 24" aria-hidden="true">
      <path d="M12 4c3.1 0 5.5 2.4 5.5 5.5v2.6c0 1.8.7 3.1 1.8 4.2l.6.6H4.1l.6-.6c1.1-1.1 1.8-2.4 1.8-4.2V9.5C6.5 6.4 8.9 4 12 4Z"
        fill="none" stroke="rgba(245,238,220,.90)" stroke-width="2.0" stroke-linejoin="round"/>
      <path d="M10 19c.5 1 1.2 1.6 2 1.6s1.5-.6 2-1.6"
        fill="none" stroke="rgba(200,60,60,.22)" stroke-width="1.9" stroke-linecap="round"/>
    </svg>
    <span id="volState" class="vol-state">MUDO</span>
  </button>

  <div id="volPanel" class="vol-panel" role="group" aria-label="Ajuste de eco">
    <div class="vol-top">
      <div class="vol-title">ECO // MIX</div>
      <div id="volReadout" class="vol-readout">70%</div>
    </div>
    <input type="range" id="volSlider" min="0" max="1" step="0.01" value="0.7" />
    <div class="vol-footer">
      <span>OUTPUT</span>
      <span class="vol-bars" aria-hidden="true"></span>
    </div>
  </div>
</div>

<!-- (mantive seus modais e conteúdo abaixo — não mexi aqui pra não explodir tamanho).
     Na Parte 3 eu te mando o JS COMPLETO, e ali eu garanto que:
     - SELOS abre/fecha com ritual
     - esc fecha tudo
     - não fica nada aberto sem clicar
-->

<!-- Seus modais originais (catalog/channels/admin/terminal/gamesPanel) podem ficar como estavam.
     Se quiser, depois eu refino a estética deles também. -->

<script>
/* ===== ELEMENTS ===== */
const video = document.getElementById("video");
const videoBlur = document.getElementById("videoBlur");
const ambience = document.getElementById("ambience");

const enterBox = document.getElementById("enterBox");
const enterHint = document.getElementById("enterHint");
const loadingScreen = document.getElementById("loadingScreen");
const dynamicText = document.getElementById("dynamicText");
const spinner = document.getElementById("spinner");

const coordA = document.getElementById("coordA");
const coordB = document.getElementById("coordB");

const sysClock = document.getElementById("sysClock");
const sysStream = document.getElementById("sysStream");
const sysNeural = document.getElementById("sysNeural");
const sysSubject = document.getElementById("sysSubject");

const sysPhase = document.getElementById("sysPhase");
const sysDirective = document.getElementById("sysDirective");

const btnFS = document.getElementById("btnFS");
const btnTerm = document.getElementById("btnTerm");
const btnCat  = document.getElementById("btnCat");
const btnLinks = document.getElementById("btnLinks");
const btnAdmin = document.getElementById("btnAdmin");

const volumeHUD = document.getElementById("volumeHUD");
const volSlider = document.getElementById("volSlider");
const volIconBtn = document.getElementById("volIconBtn");
const volReadout = document.getElementById("volReadout");
const volState = document.getElementById("volState");

const routesNode = document.getElementById("routesNode");
const rSocial = document.getElementById("rSocial");
const rGames = document.getElementById("rGames");
const rArchive = document.getElementById("rArchive");
const rTx = document.getElementById("rTx");

/* ===== FLAGS ===== */
let ambOn = true;
let hasEntered = false;

/* ===== LOADING TEXT ===== */
const messages = [
  "O TEMPLO OBSERVA…",
  "SELOS SE FECHAM…",
  "O PORTAL RESPIRA…",
  "SOMBRA EM SILÊNCIO…",
  "PRESENÇA DETECTADA…",
  "UM PASSO E NÃO VOLTA…"
];
let msgIndex = 0;
setInterval(() => {
  msgIndex = (msgIndex + 1) % messages.length;
  dynamicText.textContent = messages[msgIndex];
}, 2200);

/* ✅ ao carregar/voltar, se não entrou, fica tudo parado */
function hardStopMediaIfNotEntered(){
  if (hasEntered) return;
  try{ video.pause(); video.currentTime = 0; }catch(e){}
  try{ videoBlur.pause(); videoBlur.currentTime = 0; }catch(e){}
  try{ ambience.pause(); ambience.currentTime = 0; }catch(e){}
}
document.addEventListener("DOMContentLoaded", hardStopMediaIfNotEntered);
window.addEventListener("pageshow", () => hardStopMediaIfNotEntered());

/* ===== READY / SAFETY ===== */
let readyToEnter = false;
let scanLoopTimer = null;

function playEnterScan(){
  loadingScreen.classList.remove("scan-on");
  void loadingScreen.offsetWidth;
  loadingScreen.classList.add("scan-on");
  setTimeout(()=>loadingScreen.classList.remove("scan-on"), 1100);
}
function startScanLoop(){
  if (scanLoopTimer) return;
  scanLoopTimer = setInterval(() => {
    const loadingVisible = loadingScreen.style.display !== "none" && getComputedStyle(loadingScreen).display !== "none";
    if (!loadingVisible) return;
    if (!enterBox.classList.contains("show")) return;
    playEnterScan();
  }, 5200);
}
function setEnterHint(label){
  enterHint.textContent = (label === "RETRY") ? "PRESSIONE [ENTER] PARA TENTAR DE NOVO" : "PRESSIONE [ENTER] PARA PROSSEGUIR";
  enterHint.classList.add("show");
}
function showEnter(label="ENTRAR"){
  enterBox.style.pointerEvents = "auto";
  enterBox.textContent = label;
  enterBox.classList.add("show");
  setEnterHint(label);
  playEnterScan();
  startScanLoop();
}
function setLoadingStatus(t){ dynamicText.textContent = t; }
function markReady(){
  if (readyToEnter) return;
  readyToEnter = true;
  showEnter("ENTRAR");
}

const SAFETY_TIMEOUT_MS = 9000;
let safetyTimeout = setTimeout(() => {
  if (!readyToEnter) {
    setLoadingStatus("SINAL FRACO // ENTRADA MANUAL LIBERADA");
    markReady();
  }
}, SAFETY_TIMEOUT_MS);

setTimeout(() => {
  if (!enterBox.classList.contains("show")) {
    setLoadingStatus("PORTAL NÃO RESPONDE // ENTRADA MANUAL");
    showEnter("ENTRAR");
  }
}, 2500);

video.addEventListener("loadeddata", markReady, { once:true });
video.addEventListener("canplay", markReady, { once:true });

function onVideoError(){
  clearTimeout(safetyTimeout);
  spinner.style.display = "none";
  setLoadingStatus("RUPTURA // FALHA NO VÉU // TENTE DE NOVO");
  showEnter("RETRY");
}
video.addEventListener("error", onVideoError);
videoBlur.addEventListener("error", onVideoError);

/* ===== SYNC BLUR ===== */
video.addEventListener("play", () => { videoBlur.play().catch(()=>{}); });
video.addEventListener("pause", () => { try{ videoBlur.pause(); }catch(e){} });

/* ✅ VISIBILITY */
document.addEventListener("visibilitychange", () => {
  if (document.hidden) {
    try{ video.pause(); }catch(e){}
    try{ videoBlur.pause(); }catch(e){}
    try{ ambience.pause(); }catch(e){}
    return;
  }
  if (!hasEntered) {
    hardStopMediaIfNotEntered();
    return;
  }
  video.play().catch(()=>{});
  videoBlur.play().catch(()=>{});
  if (ambOn) ambience.play().catch(()=>{});
});

/* ===== VOLUME UI ===== */
video.volume = 0.7;
volSlider.value = String(video.volume);

function updateVolumeUI(){
  const pct = Math.round(Number(video.volume) * 100);
  volReadout.textContent = pct + "%";
  volumeHUD.style.setProperty("--bars-w", Math.max(6, pct) + "%");
  volumeHUD.style.setProperty("--bars-a", String(0.25 + (pct/100) * 0.55));
  volState.style.display = (pct === 0) ? "inline-block" : "none";
  ambience.volume = Math.min(0.35, Math.max(0.02, Number(video.volume) * 0.25));
}
volSlider.addEventListener("input", () => {
  video.volume = Number(volSlider.value);
  updateVolumeUI();
});
updateVolumeUI();

volIconBtn.addEventListener("click", (e) => {
  e.stopPropagation();
  volumeHUD.classList.toggle("open");
});
document.addEventListener("click", () => volumeHUD.classList.remove("open"));

/* ===== HUD DYNAMIC ===== */
function pad2(n){ return String(n).padStart(2,"0"); }
function tickTech(){
  const d = new Date();
  sysClock.textContent = `${pad2(d.getHours())}:${pad2(d.getMinutes())}:${pad2(d.getSeconds())}`;
  const r = Math.random();
  sysStream.textContent = video.readyState >= 3 ? "VIVO" : (video.readyState ? "LATENTE" : "DORMENTE");
  sysNeural.textContent = r > 0.92 ? "SUSSURROS" : (r > 0.75 ? "ECO" : "SILÊNCIO");
  if (sysSubject) sysSubject.textContent = hasEntered ? "NO TEMPLO" : "À PORTA";
}
setInterval(tickTech, 900);
tickTech();

function rndSeal(){
  const rune = ["Σ","Δ","Ψ","Λ","Ω","ϟ","⟡","⟁","⧫","⟟"][Math.floor(Math.random()*10)];
  const n = Math.floor(1+Math.random()*99).toString().padStart(2,"0");
  coordA.textContent = `SELO: ${rune}-${n} // CORROMP: ${Math.random()>.18?"BAIXA":"ALTA"}`;
  coordB.textContent = `PORTAL: ${Math.random()>.25?"LATENTE":"ABERTO"} // VIGIA: ${Math.random()>.15?"PRESENTE":"ATENTO"}`;
}
setInterval(rndSeal, 2200);
rndSeal();

/* ===== FULLSCREEN ===== */
async function toggleFullscreen(){
  try{
    if (!document.fullscreenElement) await document.documentElement.requestFullscreen();
    else await document.exitFullscreen();
  } catch(e){}
}
btnFS.addEventListener("click", toggleFullscreen);

/* ===== FLASH ===== */
function triggerGlitch(){
  document.body.classList.remove("glitch-on");
  void document.body.offsetWidth;
  document.body.classList.add("glitch-on");
  setTimeout(()=>document.body.classList.remove("glitch-on"), 700);
}

/* ===== SELOS NODE — ritual open/close ===== */
let sealsOpen = false;

function openSeals(){
  if (sealsOpen) return;
  sealsOpen = true;
  routesNode.classList.add("show");
  triggerGlitch();
}
function closeSeals(){
  sealsOpen = false;
  routesNode.classList.remove("show");
}
function toggleSeals(){
  sealsOpen ? closeSeals() : openSeals();
}

btnLinks.addEventListener("click", (e) => {
  e.stopPropagation();
  toggleSeals();
});

/* fecha selos ao clicar fora */
document.addEventListener("click", (e) => {
  const within = routesNode.contains(e.target) || btnLinks.contains(e.target);
  if (!within) closeSeals();
});

/* ===== ENTER ===== */
function doEnter(){
  if (!readyToEnter || hasEntered) return;
  hasEntered = true;

  loadingScreen.style.opacity = "0";
  setTimeout(()=>{ loadingScreen.style.display = "none"; }, 650);

  document.body.classList.add("entered");

  // start media
  video.currentTime = 0;
  videoBlur.currentTime = 0;
  video.play().catch(()=>{});
  videoBlur.play().catch(()=>{});
  ambience.currentTime = 0;
  if (ambOn) ambience.play().catch(()=>{});

  triggerGlitch();
}
enterBox.addEventListener("click", doEnter);
document.addEventListener("keydown", (e) => {
  if (e.key === "Enter" && !hasEntered) doEnter();
});

/* ===== ROUTES ACTIONS (por enquanto: placeholders) =====
   Como você pediu 1/4/5, aqui eu só deixo “pronto”.
   Depois você me diz se abre CHANNELS/CATALOG/GAMES etc.
*/
function sealPulse(){
  rndSeal();
  triggerGlitch();
}

rSocial?.addEventListener("click", (e)=>{ e.stopPropagation(); sealPulse(); /* abrir seu modal social aqui */ });
rGames?.addEventListener("click", (e)=>{ e.stopPropagation(); sealPulse(); /* abrir arena aqui */ });
rArchive?.addEventListener("click", (e)=>{ e.stopPropagation(); sealPulse(); /* abrir arquivo aqui */ });
rTx?.addEventListener("click", (e)=>{ e.stopPropagation(); sealPulse(); volumeHUD.classList.toggle("open"); });

/* ===== ESC: fecha o que estiver aberto (aqui: seals + volume) ===== */
document.addEventListener("keydown", (e) => {
  if (e.key !== "Escape") return;
  closeSeals();
  volumeHUD.classList.remove("open");
});

/* fim */
</script>
</body>
</html>
