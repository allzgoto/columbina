<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dottore</title>

<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{background:black;overflow:hidden;font-family:Arial;}

#video{
    position:fixed;
    inset:0;
    width:100%;
    height:100%;
    object-fit:contain;
    background:black;
    z-index:-1;
}

/* LOADING SCREEN */
#loadingScreen{
    position:fixed;
    inset:0;
    background:radial-gradient(circle at center,#0a0a12,#000);
    display:flex;
    flex-direction:column;
    justify-content:center;
    align-items:center;
    color:white;
    z-index:10;
}

.loading-text{
    letter-spacing:4px;
    margin-bottom:20px;
    opacity:.7;
}

.progress-bar{
    width:300px;
    height:4px;
    background:rgba(255,255,255,.1);
    border-radius:4px;
    overflow:hidden;
}

.progress-fill{
    width:0%;
    height:100%;
    background:linear-gradient(90deg,#00d4ff,#ffffff);
    transition:width .2s ease;
}

/* ENTER */
#enterBox{
    margin-top:40px;
    padding:18px 60px;
    border-radius:12px;
    background:rgba(255,255,255,.08);
    border:1px solid rgba(255,255,255,.2);
    backdrop-filter:blur(15px);
    cursor:pointer;
    opacity:0;
    transition:.4s;
    letter-spacing:6px;
}

#enterBox.show{
    opacity:1;
}
</style>
</head>
<body>

<video id="video" playsinline preload="auto">
    <source src="https://files.catbox.moe/um6f2u.mp4" type="video/mp4">
</video>

<div id="loadingScreen">
    <div class="loading-text">INITIALIZING EXPERIMENT...</div>
    <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
    </div>
    <div id="enterBox">ENTER</div>
</div>

<script>

const video = document.getElementById("video");
const progressFill = document.getElementById("progressFill");
const enterBox = document.getElementById("enterBox");
const loadingScreen = document.getElementById("loadingScreen");

/* Progresso real baseado em buffer */
video.addEventListener("progress", ()=>{
    if(video.buffered.length > 0){
        const bufferedEnd = video.buffered.end(video.buffered.length - 1);
        const duration = video.duration;
        if(duration > 0){
            const percent = (bufferedEnd / duration) * 100;
            progressFill.style.width = percent + "%";

            if(percent > 20){ // já dá pra iniciar suave
                enterBox.classList.add("show");
            }
        }
    }
});

/* Garantir duração carregada */
video.addEventListener("loadedmetadata", ()=>{
    console.log("Metadata carregada");
});

/* START */
enterBox.addEventListener("click", ()=>{
    video.play().then(()=>{
        loadingScreen.style.opacity="0";
        setTimeout(()=>loadingScreen.style.display="none",600);
    });
});

/* LOOP */
video.addEventListener("ended",()=>{
    video.currentTime=0;
    video.play();
});

</script>

</body>
</html>
