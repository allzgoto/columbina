<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>ALLZ HUB</title>

  <style>
    :root{
      /* ====== TEMA (ESCURO default) ====== */
      --bg:#050507;
      --bgSoft1: rgba(255,140,50,.06);
      --bgSoft2: rgba(255,255,255,.03);

      --glass: rgba(0,0,0,.38);
      --panelStroke: rgba(255,255,255,.12);
      --panelStroke2: rgba(255,255,255,.14);

      --text: rgba(255,255,255,.90);
      --muted: rgba(255,255,255,.60);
      --muted2: rgba(255,255,255,.48);

      --orange: rgba(255,140,50,.92);

      /* XP-ish bevel */
      --bevelTop: rgba(255,255,255,.26);
      --bevelBot: rgba(0,0,0,.90);

      --good:#43d17a;
      --idle:#f2c14e;
      --dnd:#ff4d4d;
      --offline:#8b8f9a;

      --mono: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
      --ui: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Noto Sans", "Liberation Sans", sans-serif;
    }

    /* ====== TEMA CLARO (XP branco) ====== */
    body[data-theme="xp"]{
      --bg: #e9edf5;
      --bgSoft1: rgba(0,0,0,.06);
      --bgSoft2: rgba(0,0,0,.04);

      --glass: rgba(255,255,255,.62);
      --panelStroke: rgba(0,0,0,.14);
      --panelStroke2: rgba(0,0,0,.18);

      --text: rgba(0,0,0,.86);
      --muted: rgba(0,0,0,.62);
      --muted2: rgba(0,0,0,.48);

      --bevelTop: rgba(255,255,255,.75);
      --bevelBot: rgba(0,0,0,.35);
    }

    *{ box-sizing:border-box }
    html,body{ height:100% }
    body{
      margin:0;
      background: var(--bg);
      color: var(--text);
      font-family: var(--ui);
      overflow:hidden;
    }

    /* fundo discreto */
    .bg-soft{
      position:fixed; inset:0;
      pointer-events:none;
      background:
        radial-gradient(900px 520px at 55% 30%, var(--bgSoft1), transparent 60%),
        radial-gradient(700px 420px at 40% 70%, var(--bgSoft2), transparent 65%),
        linear-gradient(180deg, rgba(255,255,255,.02), transparent 40%, rgba(0,0,0,.10));
      opacity:.95;
    }
    body[data-theme="xp"] .bg-soft{
      background:
        radial-gradient(900px 520px at 55% 30%, rgba(0,0,0,.06), transparent 60%),
        radial-gradient(700px 420px at 40% 70%, rgba(0,0,0,.04), transparent 65%),
        linear-gradient(180deg, rgba(255,255,255,.42), transparent 45%, rgba(0,0,0,.06));
      opacity:.95;
    }

    .bg-noise{
      position:fixed; inset:0;
      pointer-events:none;
      opacity:.30;
      mix-blend-mode:overlay;
      background:
        repeating-linear-gradient(0deg, rgba(255,255,255,.03), rgba(255,255,255,.03) 1px, transparent 1px, transparent 4px),
        repeating-linear-gradient(90deg, rgba(255,255,255,.02), rgba(255,255,255,.02) 1px, transparent 1px, transparent 6px);
      filter:contrast(110%) saturate(105%);
    }
    body[data-theme="xp"] .bg-noise{
      opacity:.22;
      mix-blend-mode:multiply;
      filter:contrast(105%);
    }

    #particles{
      position:fixed; inset:0;
      z-index:0;
    }

    /* ===== ENTER (só a palavra) ===== */
    .enter{
      position:fixed; inset:0;
      z-index:80;
      display:flex;
      align-items:center;
      justify-content:center;
      background:#000;
      cursor:pointer;
      user-select:none;
    }

    .enter-word{
      font-family: var(--mono);
      font-size: 22px;
      letter-spacing: .55em;
      text-transform: uppercase;
      color: rgba(255,255,255,.86);
      text-shadow: 0 0 16px rgba(255,140,50,.10);
      position:relative;
      transition: .14s ease;
    }
    .enter:hover .enter-word{
      color: rgba(255,255,255,.96);
      text-shadow: 0 0 22px rgba(255,140,50,.20);
      filter: brightness(1.05);
    }
    .enter-word::after{
      content:"";
      position:absolute;
      right:-14px;
      top:50%;
      width:8px;
      height:1px;
      background: rgba(255,140,50,.75);
      transform: translateY(-50%);
      opacity:.0;
      animation: blink 1.05s infinite ease;
    }
    @keyframes blink{
      0%,45%{ opacity:0; }
      55%,100%{ opacity:.95; }
    }

    /* flash CRT no ENTER */
    .crtflash{
      position:fixed; inset:0;
      pointer-events:none;
      z-index:90;
      opacity:0;
      background:
        radial-gradient(900px 500px at 50% 45%, rgba(255,255,255,.22), transparent 60%),
        repeating-linear-gradient(0deg, rgba(255,255,255,.06), rgba(255,255,255,.06) 1px, transparent 1px, transparent 3px);
      mix-blend-mode:screen;
    }
    .crtflash.on{
      animation: crt 120ms ease-out forwards;
    }
    @keyframes crt{
      0%{ opacity:0; }
      25%{ opacity:1; }
      100%{ opacity:0; }
    }

    /* ===== APP ===== */
    .app{
      position:relative;
      z-index:1;
      height:100%;
      display:none;
      grid-template-columns: 290px minmax(520px, 1fr);
      gap:14px;
      padding:14px;
    }

    .panel{
      border-radius:14px;
      border:1px solid var(--panelStroke);
      background: var(--glass);
      box-shadow: 0 20px 60px rgba(0,0,0,.60);
      overflow:hidden;
      position:relative;
      backdrop-filter: blur(4px);
    }
    body[data-theme="xp"] .panel{
      box-shadow: 0 18px 45px rgba(0,0,0,.18);
      backdrop-filter: blur(2px);
    }

    .panel:before{
      content:"";
      position:absolute; inset:0;
      pointer-events:none;
      background:
        radial-gradient(520px 260px at 25% 20%, rgba(255,140,50,.10), transparent 60%),
        radial-gradient(420px 240px at 85% 85%, rgba(255,255,255,.05), transparent 65%);
      opacity:.75;
    }
    body[data-theme="xp"] .panel:before{
      opacity:.32;
      background:
        radial-gradient(520px 260px at 25% 20%, rgba(0,0,0,.08), transparent 60%),
        radial-gradient(420px 240px at 85% 85%, rgba(0,0,0,.05), transparent 65%);
    }

    /* ===== MENU ESQUERDO (mais Paint) ===== */
    .menu{
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .xp-titlebar{
      position:relative; z-index:1;
      display:flex; align-items:center; justify-content:space-between;
      padding:8px 10px;
      border-radius:10px;

      border:1px solid var(--panelStroke2);
      border-top-color: var(--bevelTop);
      border-left-color: var(--bevelTop);
      border-right-color: rgba(0,0,0,.76);
      border-bottom-color: var(--bevelBot);

      background:
        linear-gradient(180deg, rgba(58,58,78,.55), rgba(12,12,18,.55));
    }
    body[data-theme="xp"] .xp-titlebar{
      background: linear-gradient(180deg, rgba(255,255,255,.72), rgba(240,243,250,.62));
    }

    .xp-titlebar .left{
      display:flex; align-items:center; gap:10px;
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--text);
    }
    .mini-lights{ display:flex; gap:6px; opacity:.95; }
    .mini-lights span{
      width:10px; height:10px; border-radius:3px;
      border:1px solid rgba(255,255,255,.18);
      background: rgba(255,255,255,.06);
      box-shadow: 0 0 0 2px rgba(0,0,0,.35) inset;
    }
    body[data-theme="xp"] .mini-lights span{
      border-color: rgba(0,0,0,.20);
      box-shadow: 0 0 0 2px rgba(255,255,255,.55) inset;
    }

    .mini-lights span:nth-child(2){ background: rgba(255,140,50,.14); }
    .xp-titlebar .right{
      font-family:var(--mono);
      font-size:10px;
      color:var(--muted);
      letter-spacing:.10em;
      text-transform:uppercase;
    }

    .toolbox{
      position:relative; z-index:1;
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:8px;
      padding:10px;
      border-radius:12px;
      border:1px solid var(--panelStroke);
      background: rgba(0,0,0,.18);
    }
    body[data-theme="xp"] .toolbox{
      background: rgba(255,255,255,.35);
    }

    .toolbtn{
      all:unset;
      cursor:pointer;
      user-select:none;

      display:flex;
      align-items:center;
      gap:10px;

      padding:10px 10px;
      border-radius:10px;

      border:1px solid rgba(255,255,255,.18);
      border-top-color: var(--bevelTop);
      border-left-color: var(--bevelTop);
      border-right-color: rgba(0,0,0,.78);
      border-bottom-color: var(--bevelBot);

      background:
        linear-gradient(180deg, rgba(255,255,255,.09), rgba(255,255,255,.02)),
        rgba(12,12,15,.58);

      box-shadow:
        0 1px 0 rgba(255,255,255,.07) inset,
        0 -1px 0 rgba(0,0,0,.45) inset;

      transition: transform .10s ease, border-color .12s ease, filter .12s ease, box-shadow .12s ease;
      position:relative;
    }
    body[data-theme="xp"] .toolbtn{
      background:
        linear-gradient(180deg, rgba(255,255,255,.85), rgba(235,240,250,.70));
      box-shadow:
        0 1px 0 rgba(255,255,255,.65) inset,
        0 -1px 0 rgba(0,0,0,.10) inset;
      border-color: rgba(0,0,0,.14);
      border-right-color: rgba(0,0,0,.22);
      border-bottom-color: rgba(0,0,0,.26);
    }

    .toolbtn:hover{
      transform: translateY(-1px);
      border-color: rgba(255,140,50,.32);
      filter:brightness(1.07);
    }
    body[data-theme="xp"] .toolbtn:hover{
      border-color: rgba(0,0,0,.24);
      filter:brightness(1.02);
    }

    /* pressed XP */
    .toolbtn:active{
      transform: translateY(0px);
      box-shadow:
        0 2px 0 rgba(0,0,0,.55) inset,
        0 -1px 0 rgba(255,255,255,.05) inset;
      filter:brightness(1.03);
    }
    body[data-theme="xp"] .toolbtn:active{
      box-shadow:
        0 2px 0 rgba(0,0,0,.18) inset,
        0 -1px 0 rgba(255,255,255,.55) inset;
    }

    .toolbtn.active{
      border-color: rgba(255,140,50,.50);
      box-shadow:
        0 0 0 1px rgba(255,140,50,.12) inset,
        0 0 22px rgba(255,140,50,.10),
        0 2px 0 rgba(0,0,0,.45) inset;
    }
    body[data-theme="xp"] .toolbtn.active{
      border-color: rgba(0,0,0,.30);
      box-shadow:
        0 0 0 1px rgba(0,0,0,.08) inset,
        0 2px 0 rgba(0,0,0,.12) inset;
    }

    /* ícone “old” */
    .tool-ico{
      width:22px; height:22px;
      border-radius:6px;
      border:1px solid rgba(255,255,255,.14);
      background:
        linear-gradient(180deg, rgba(255,255,255,.08), rgba(0,0,0,.06)),
        rgba(255,255,255,.04);
      display:grid; place-items:center;
      font-family:var(--mono);
      font-size:12px;
      color:var(--text);
      image-rendering: pixelated;
    }
    body[data-theme="xp"] .tool-ico{
      border-color: rgba(0,0,0,.18);
      background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(240,243,250,.70));
      color: rgba(0,0,0,.76);
    }

    .tool-label{
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.10em;
      text-transform:uppercase;
      color:var(--text);
    }

    /* Tooltip estilo Windows (só CSS) */
    .toolbtn[data-tip]:hover::after{
      content: attr(data-tip);
      position:absolute;
      left: 10px;
      top: 100%;
      margin-top:8px;
      z-index:99;

      padding:7px 9px;
      border-radius:10px;

      border:1px solid rgba(255,255,255,.14);
      border-top-color: rgba(255,255,255,.22);
      border-left-color: rgba(255,255,255,.20);
      border-right-color: rgba(0,0,0,.78);
      border-bottom-color: rgba(0,0,0,.90);

      background: rgba(0,0,0,.78);
      color: rgba(255,255,255,.88);

      font-family: var(--mono);
      font-size:10px;
      letter-spacing:.06em;
      white-space:nowrap;
      box-shadow: 0 18px 40px rgba(0,0,0,.60);
      pointer-events:none;
    }
    body[data-theme="xp"] .toolbtn[data-tip]:hover::after{
      background: rgba(255,255,255,.95);
      color: rgba(0,0,0,.78);
      border-color: rgba(0,0,0,.22);
      box-shadow: 0 18px 40px rgba(0,0,0,.20);
    }

    .profile{
      position:relative; z-index:1;
      margin-top:auto;
      padding:10px 12px;
      border-radius:12px;
      border:1px solid var(--panelStroke);
      background: rgba(0,0,0,.18);
    }
    body[data-theme="xp"] .profile{
      background: rgba(255,255,255,.35);
    }
    .profile .name{
      font-family:var(--mono);
      font-size:12px;
      letter-spacing:.10em;
      text-transform:uppercase;
      color:var(--text);
    }
    .profile .tag{
      margin-top:6px;
      font-family:var(--mono);
      font-size:11px;
      color:var(--muted);
      letter-spacing:.06em;
    }

    /* ===== CENTRO ===== */
    .center{
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .topbar{
      position:relative; z-index:1;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;

      padding:10px 10px;
      border-radius:12px;

      border:1px solid var(--panelStroke);
      background: rgba(0,0,0,.18);
    }
    body[data-theme="xp"] .topbar{
      background: rgba(255,255,255,.35);
    }

    .crumb{
      display:flex; align-items:center; gap:10px;
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.10em;
      text-transform:uppercase;
      color:var(--muted);
    }
    .crumb .dot{
      width:7px; height:7px; border-radius:999px;
      background: rgba(255,140,50,.55);
      box-shadow: 0 0 12px rgba(255,140,50,.18);
    }

    .audio-ctrl{ display:flex; align-items:center; gap:8px; }
    .btn-bevel{
      all:unset;
      cursor:pointer;
      user-select:none;

      padding:9px 10px;
      border-radius:10px;

      border:1px solid rgba(255,255,255,.16);
      border-top-color: var(--bevelTop);
      border-left-color: var(--bevelTop);
      border-right-color: rgba(0,0,0,.78);
      border-bottom-color: var(--bevelBot);

      background:
        linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.02)),
        rgba(12,12,15,.55);

      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.10em;
      text-transform:uppercase;
      color:var(--text);

      transition: transform .10s ease, border-color .12s ease, filter .12s ease, box-shadow .12s ease;
    }
    body[data-theme="xp"] .btn-bevel{
      background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(235,240,250,.70));
      border-color: rgba(0,0,0,.18);
      border-right-color: rgba(0,0,0,.22);
      border-bottom-color: rgba(0,0,0,.26);
      color: rgba(0,0,0,.78);
    }

    .btn-bevel:hover{ transform: translateY(-1px); border-color: rgba(255,140,50,.30); filter:brightness(1.07); }
    .btn-bevel:active{
      transform: translateY(0px);
      box-shadow: 0 2px 0 rgba(0,0,0,.55) inset;
      filter:brightness(1.03);
    }
    body[data-theme="xp"] .btn-bevel:hover{ border-color: rgba(0,0,0,.26); filter:brightness(1.02); }
    body[data-theme="xp"] .btn-bevel:active{ box-shadow: 0 2px 0 rgba(0,0,0,.18) inset; }

    /* Barra fake “Arquivo Editar Exibir Ajuda” + ticker */
    .menubar{
      position:relative; z-index:1;
      display:flex;
      gap:14px;
      align-items:center;

      padding:8px 10px;
      border-radius:12px;

      border:1px solid var(--panelStroke);
      background: rgba(0,0,0,.14);

      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.08em;
      color:var(--muted);
    }
    body[data-theme="xp"] .menubar{
      background: rgba(255,255,255,.40);
    }

    .menubar .item{
      cursor:default;
      padding:4px 6px;
      border-radius:8px;
      border:1px solid transparent;
    }
    .menubar .item:hover{
      border-color: rgba(255,255,255,.12);
      background: rgba(255,255,255,.04);
      color: rgba(255,255,255,.80);
    }
    body[data-theme="xp"] .menubar .item:hover{
      border-color: rgba(0,0,0,.16);
      background: rgba(0,0,0,.04);
      color: rgba(0,0,0,.78);
    }

    .menubar .sep{
      margin-left:auto;
      font-size:10px;
      color:var(--muted2);
      letter-spacing:.10em;
    }

    .ticker{
      position:relative;
      height:18px;
      overflow:hidden;
      margin-left:8px;
      flex:1;
      mask-image: linear-gradient(90deg, transparent, #000 10%, #000 90%, transparent);
      opacity:.85;
    }
    .ticker span{
      position:absolute;
      white-space:nowrap;
      font-family:var(--mono);
      font-size:10px;
      letter-spacing:.08em;
      color: var(--muted2);
      animation: scroll 22s linear infinite;
    }
    @keyframes scroll{
      0%{ transform: translateX(100%); }
      100%{ transform: translateX(-120%); }
    }

    .stage{
      flex:1;
      display:grid;
      place-items:center;
      padding:6px 6px 10px;
      position:relative;
      z-index:1;
    }

    /* ===== VIDEO MAIS “PESO” (maior, sem fullscreen) ===== */
    .video-shell{
      width:min(1100px, 100%);     /* era 980 */
      border-radius:14px;
      overflow:hidden;
      border:1px solid var(--panelStroke2);
      background: rgba(0,0,0,.28);
      box-shadow:
        0 0 0 1px rgba(255,255,255,.05) inset,
        0 28px 90px rgba(0,0,0,.70);
      position:relative;
    }
    body[data-theme="xp"] .video-shell{
      background: rgba(255,255,255,.45);
      box-shadow:
        0 0 0 1px rgba(0,0,0,.08) inset,
        0 22px 60px rgba(0,0,0,.18);
    }

    video{
      display:block;
      width:100%;
      height:auto;
      max-height: 74vh;            /* era 70 */
      background:#000;
    }

    /* overlay AMV antigo + scanlines */
    .amv-overlay{
      position:absolute; inset:0;
      pointer-events:none;
      z-index:5;
    }
    .amv-overlay:before{
      content:"";
      position:absolute; inset:0;
      background:
        radial-gradient(900px 450px at 50% 50%, transparent 35%, rgba(0,0,0,.62) 78%),
        repeating-linear-gradient(0deg, rgba(255,255,255,.03), rgba(255,255,255,.03) 1px, transparent 1px, transparent 4px);
      opacity:.78;
      mix-blend-mode:overlay;
    }

    .bandicam{
      position:absolute; top:10px; left:12px;
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.88);
      text-shadow: 0 2px 12px rgba(0,0,0,.95);
      letter-spacing:.04em;
    }
    .timestamp{
      position:absolute; top:10px; right:12px;
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.82);
      text-shadow: 0 2px 12px rgba(0,0,0,.95);
      letter-spacing:.04em;
    }
    .caption{
      position:absolute; bottom:10px; left:12px;
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.80);
      text-shadow: 0 2px 14px rgba(0,0,0,.98);
      letter-spacing:.06em;
      opacity:.95;
    }

    /* “assinatura” + REC */
    .rec{
      position:absolute;
      top:32px;
      left:12px;
      display:flex;
      align-items:center;
      gap:8px;
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.10em;
      color:rgba(255,255,255,.70);
      text-shadow: 0 2px 12px rgba(0,0,0,.95);
      opacity:.85;
    }
    .rec .dot{
      width:7px; height:7px; border-radius:999px;
      background: rgba(255,70,70,.65);
      box-shadow: 0 0 10px rgba(255,70,70,.22);
      animation: recblink 1.1s infinite ease;
    }
    @keyframes recblink{
      0%,45%{ opacity:.15; }
      55%,100%{ opacity:.95; }
    }

    .sig{
      position:absolute;
      bottom:10px;
      right:12px;
      font-family:var(--mono);
      font-size:10px;
      letter-spacing:.14em;
      text-transform:uppercase;
      color:rgba(255,255,255,.45);
      text-shadow: 0 2px 12px rgba(0,0,0,.95);
      opacity:.85;
    }

    /* ===== MODAL “JANELA” com micro animação ===== */
    .modal{
      position:fixed; inset:0;
      z-index:70;
      display:none;
      align-items:center;
      justify-content:center;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(2px);
      padding:14px;
    }
    body[data-theme="xp"] .modal{
      background: rgba(0,0,0,.32);
      backdrop-filter: blur(1px);
    }
    .modal.open{ display:flex; }

    .window{
      width:min(920px, 96vw);
      max-height:min(78vh, 760px);
      display:flex;
      flex-direction:column;

      border-radius:14px;
      overflow:hidden;

      border:1px solid var(--panelStroke2);
      background: rgba(0,0,0,.45);
      box-shadow: 0 30px 100px rgba(0,0,0,.80);

      opacity:0;
      transform: translateY(6px);
      transition: 120ms ease;
    }
    body[data-theme="xp"] .window{
      background: rgba(255,255,255,.72);
      box-shadow: 0 24px 70px rgba(0,0,0,.25);
    }

    .modal.open .window{
      opacity:1;
      transform: translateY(0px);
    }

    .winbar{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      padding:10px 10px;

      border-bottom:1px solid rgba(255,255,255,.10);
      background:
        linear-gradient(180deg, rgba(58,58,78,.55), rgba(12,12,18,.55));

      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:rgba(255,255,255,.84);
    }
    body[data-theme="xp"] .winbar{
      background: linear-gradient(180deg, rgba(255,255,255,.82), rgba(235,240,250,.70));
      color: rgba(0,0,0,.78);
      border-bottom-color: rgba(0,0,0,.12);
    }

    .winbar .left{ display:flex; align-items:center; gap:10px; }
    .winbar .pilldot{
      width:7px; height:7px; border-radius:999px;
      background: rgba(255,140,50,.55);
      box-shadow: 0 0 12px rgba(255,140,50,.18);
    }

    .close{
      all:unset;
      cursor:pointer;
      user-select:none;
      width:34px; height:28px;
      border-radius:10px;

      border:1px solid rgba(255,255,255,.16);
      border-top-color: var(--bevelTop);
      border-left-color: var(--bevelTop);
      border-right-color: rgba(0,0,0,.78);
      border-bottom-color: var(--bevelBot);

      background:
        linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.02)),
        rgba(12,12,15,.55);

      display:grid; place-items:center;
      font-family:var(--mono);
      font-size:12px;
      color:rgba(255,255,255,.78);
      transition:.10s ease;
    }
    body[data-theme="xp"] .close{
      background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(235,240,250,.70));
      border-color: rgba(0,0,0,.18);
      border-right-color: rgba(0,0,0,.22);
      border-bottom-color: rgba(0,0,0,.26);
      color: rgba(0,0,0,.78);
    }
    .close:hover{ border-color: rgba(255,140,50,.30); transform: translateY(-1px); filter:brightness(1.07); }
    .close:active{ transform: translateY(0px); box-shadow: 0 2px 0 rgba(0,0,0,.55) inset; }
    body[data-theme="xp"] .close:hover{ border-color: rgba(0,0,0,.26); filter:brightness(1.02); }
    body[data-theme="xp"] .close:active{ box-shadow: 0 2px 0 rgba(0,0,0,.18) inset; }

    .winbody{
      padding:12px;
      overflow:auto;
    }

    .card{
      border-radius:12px;
      border:1px solid var(--panelStroke);
      background: rgba(0,0,0,.18);
      padding:12px;
      position:relative;
      overflow:hidden;
    }
    body[data-theme="xp"] .card{
      background: rgba(255,255,255,.42);
    }

    .card:before{
      content:"";
      position:absolute; inset:-1px;
      pointer-events:none;
      background:
        radial-gradient(420px 220px at 22% 15%, rgba(255,140,50,.10), transparent 60%),
        radial-gradient(420px 220px at 78% 85%, rgba(255,255,255,.05), transparent 65%);
      opacity:.55;
    }
    body[data-theme="xp"] .card:before{
      opacity:.22;
      background:
        radial-gradient(420px 220px at 22% 15%, rgba(0,0,0,.08), transparent 60%),
        radial-gradient(420px 220px at 78% 85%, rgba(0,0,0,.05), transparent 65%);
    }
    .card > *{ position:relative; z-index:1; }

    .grid{
      display:grid;
      grid-template-columns: 1.2fr .8fr;
      gap:10px;
    }

    .h3{
      margin:0 0 10px 0;
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.12em;
      text-transform:uppercase;
      color:var(--muted);
    }

    .mini{
      font-family:var(--mono);
      font-size:11px;
      color:var(--muted);
      letter-spacing:.06em;
      line-height:1.5;
    }

    .social-hero{ display:flex; align-items:center; gap:12px; }
    .social-ava{
      width:72px; height:72px;
      border-radius:12px;
      border:1px solid rgba(255,140,50,.30);
      background:
        radial-gradient(circle at 35% 30%, rgba(255,140,50,.25), transparent 60%),
        rgba(255,255,255,.05);
      box-shadow: 0 0 22px rgba(255,140,50,.10);
      display:grid; place-items:center;
      font-family:var(--mono);
      letter-spacing:.10em;
      color:rgba(255,255,255,.70);
    }
    body[data-theme="xp"] .social-ava{
      color: rgba(0,0,0,.72);
      background:
        radial-gradient(circle at 35% 30%, rgba(0,0,0,.10), transparent 60%),
        rgba(255,255,255,.75);
      box-shadow: 0 0 22px rgba(0,0,0,.10);
    }

    .social-hero strong{ display:block; font-size:20px; letter-spacing:.02em; }
    .social-hero span{
      display:block;
      margin-top:4px;
      font-family:var(--mono);
      color:var(--muted);
      font-size:12px;
      letter-spacing:.06em;
    }

    .pill{
      display:inline-flex; align-items:center; gap:8px;
      margin-top:10px;
      padding:7px 10px;
      border-radius:999px;
      border:1px solid var(--panelStroke);
      background: rgba(0,0,0,.14);
      font-family:var(--mono);
      font-size:11px;
      color:var(--muted);
      letter-spacing:.06em;
    }
    body[data-theme="xp"] .pill{
      background: rgba(255,255,255,.45);
    }

    .pill .pdot{
      width:7px;height:7px;border-radius:999px;
      background: rgba(255,140,50,.55);
      box-shadow: 0 0 12px rgba(255,140,50,.18);
    }

    .btnrow{ display:flex; flex-wrap:wrap; gap:8px; margin-top:12px; }
    .linkbtn{
      text-decoration:none;
      display:inline-flex; align-items:center; gap:8px;

      padding:9px 10px;
      border-radius:10px;

      border:1px solid rgba(255,255,255,.16);
      border-top-color: var(--bevelTop);
      border-left-color: var(--bevelTop);
      border-right-color: rgba(0,0,0,.78);
      border-bottom-color: var(--bevelBot);

      background:
        linear-gradient(180deg, rgba(255,255,255,.10), rgba(255,255,255,.02)),
        rgba(12,12,15,.55);

      color:var(--text);
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.10em;
      text-transform:uppercase;
      transition:.10s ease;
    }
    body[data-theme="xp"] .linkbtn{
      background: linear-gradient(180deg, rgba(255,255,255,.85), rgba(235,240,250,.70));
      border-color: rgba(0,0,0,.18);
      border-right-color: rgba(0,0,0,.22);
      border-bottom-color: rgba(0,0,0,.26);
      color: rgba(0,0,0,.78);
    }

    .linkbtn:hover{ border-color: rgba(255,140,50,.30); transform: translateY(-1px); filter:brightness(1.07); }
    .linkbtn:active{ transform: translateY(0px); box-shadow: 0 2px 0 rgba(0,0,0,.55) inset; }
    body[data-theme="xp"] .linkbtn:hover{ border-color: rgba(0,0,0,.26); filter:brightness(1.02); }
    body[data-theme="xp"] .linkbtn:active{ box-shadow: 0 2px 0 rgba(0,0,0,.18) inset; }

    /* ===== Discord widget (COMPACTO, sem barra enorme) ===== */
    .discord-compact{
      position:fixed;
      left:12px;
      bottom:12px;
      z-index:25;

      display:flex;
      align-items:center;
      gap:10px;

      width:min(320px, calc(100vw - 24px));
      padding:10px 10px;

      border-radius:14px;
      border:1px solid var(--panelStroke2);

      background: rgba(0,0,0,.40);
      backdrop-filter: blur(4px);

      box-shadow: 0 20px 60px rgba(0,0,0,.70);
      overflow:hidden;
    }
    body[data-theme="xp"] .discord-compact{
      background: rgba(255,255,255,.75);
      box-shadow: 0 18px 45px rgba(0,0,0,.22);
      backdrop-filter: blur(2px);
    }

    .d-ava{
      width:44px; height:44px;
      border-radius:12px;
      border:1px solid var(--panelStroke2);
      background: rgba(255,255,255,.06);
      overflow:hidden;
      flex:0 0 auto;
    }
    body[data-theme="xp"] .d-ava{ background: rgba(0,0,0,.04); }

    .d-ava img{ width:100%; height:100%; object-fit:cover; display:block; }

    .d-meta{
      min-width:0;
      display:flex;
      flex-direction:column;
      gap:5px;
      flex:1;
    }

    .d-top{
      display:flex;
      align-items:baseline;
      gap:8px;
      min-width:0;
    }

    .d-nick{
      font-family:var(--mono);
      font-size:12px;
      letter-spacing:.08em;
      text-transform:uppercase;
      color:var(--text);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 140px;
    }

    .d-user{
      font-family:var(--mono);
      font-size:10px;
      letter-spacing:.08em;
      color:var(--muted2);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 120px;
    }

    .d-status{
      display:flex;
      align-items:center;
      gap:8px;
      font-family:var(--mono);
      font-size:11px;
      letter-spacing:.06em;
      color:var(--muted);
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }

    .status-dot{
      width:8px; height:8px; border-radius:999px;
      background: var(--offline);
      box-shadow: 0 0 12px rgba(255,255,255,.08);
      flex:0 0 auto;
    }

    .d-mini{
      margin-left:auto;
      text-align:right;
      display:flex;
      flex-direction:column;
      gap:5px;
      flex:0 0 auto;
      font-family:var(--mono);
      font-size:10px;
      letter-spacing:.08em;
      color:var(--muted2);
    }
    .d-mini .live{
      text-transform:uppercase;
      letter-spacing:.10em;
    }

    .hidden{ display:none !important; }

    @media (max-width: 980px){
      body{ overflow:auto; }
      .app{ grid-template-columns: 1fr; height:auto; }
      video{ max-height: 52vh; }
      .discord-compact{
        position:static;
        width:calc(100% - 28px);
        margin: 0 14px 14px;
      }
      .menubar{ flex-wrap:wrap; }
      .ticker{ flex-basis:100%; margin-left:0; }
    }
  </style>
</head>

<body data-theme="dark">
  <canvas id="particles"></canvas>
  <div class="bg-soft"></div>
  <div class="bg-noise"></div>

  <!-- CRT flash -->
  <div class="crtflash" id="crtflash"></div>

  <!-- ENTER -->
  <div class="enter" id="enter" aria-label="Clique para entrar">
    <div class="enter-word">ENTER</div>
  </div>

  <!-- APP -->
  <div class="app" id="app">
    <!-- MENU -->
    <aside class="panel menu">
      <div class="xp-titlebar">
        <div class="left">
          <div class="mini-lights" aria-hidden="true"><span></span><span></span><span></span></div>
          <div>allz.exe</div>
        </div>
        <div class="right">toolbox</div>
      </div>

      <nav class="toolbox" id="nav">
        <button class="toolbtn" data-view="social" data-tip="social media / links / perfil">
          <span class="tool-ico">☺</span>
          <span class="tool-label">social</span>
        </button>

        <button class="toolbtn" data-view="archives" data-tip="jogos / progresso / arquivos">
          <span class="tool-ico">▦</span>
          <span class="tool-label">arquivos</span>
        </button>

        <button class="toolbtn" data-view="playlists" data-tip="músicas favoritas / listas">
          <span class="tool-ico">♪</span>
          <span class="tool-label">playlists</span>
        </button>

        <button class="toolbtn" data-view="admin" data-tip="login privado / interno">
          <span class="tool-ico">★</span>
          <span class="tool-label">admin</span>
        </button>
      </nav>

      <div class="profile">
        <div class="name">Allz.exe</div>
        <div class="tag">awake and unafraid</div>
      </div>
    </aside>

    <!-- CENTER -->
    <main class="panel center">
      <div class="topbar">
        <div class="crumb"><span class="dot"></span><span>ALLZ HUB</span></div>
        <div class="audio-ctrl">
          <button class="btn-bevel" id="themeBtn" title="Alternar tema (T)">TEMA</button>
          <button class="btn-bevel" id="muteBtn">MUTAR</button>
        </div>
      </div>

      <div class="menubar" aria-hidden="true">
        <div class="item">Arquivo</div>
        <div class="item">Editar</div>
        <div class="item">Exibir</div>
        <div class="item">Ajuda</div>

        <div class="ticker">
          <span id="tickerText">ALLZ HUB — nostalgia internet antiga + UI dark moderna — Bandicam vibes — awake and unafraid —</span>
        </div>

        <div class="sep" id="themeLabel">ESCURO</div>
      </div>

      <section class="stage">
        <div class="video-shell">
          <video id="amv" playsinline muted autoplay loop preload="auto">
            <source src="https://files.catbox.moe/fhahqy.mp4" type="video/mp4">
          </video>

          <div class="amv-overlay">
            <div class="bandicam">Bandicam.com</div>
            <div class="rec"><span class="dot"></span>REC</div>
            <div class="timestamp" id="ts">00:00:00</div>
            <div class="caption">ALLZ HUB / awake and unafraid</div>
            <div class="sig">ALLZ_2009</div>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- MODAL / JANELAS -->
  <div class="modal" id="modal">
    <div class="window" role="dialog" aria-modal="true" aria-label="Janela">
      <div class="winbar">
        <div class="left">
          <span class="pilldot"></span>
          <span id="winTitle">SOCIAL</span>
        </div>
        <div class="right">
          <button class="close" id="closeWin" aria-label="Fechar">✕</button>
        </div>
      </div>

      <div class="winbody">
        <!-- SOCIAL -->
        <div id="pane-social" class="pane hidden">
          <div class="grid">
            <div class="card">
              <div class="h3">Perfil</div>
              <div class="social-hero">
                <div class="social-ava">ALLZ</div>
                <div>
                  <strong>Allz</strong>
                  <span>awake and unafraid</span>
                  <div class="pill"><span class="pdot"></span> purgatório</div>
                </div>
              </div>

              <div class="btnrow">
                <!-- bota teus links reais -->
                <a class="linkbtn" href="#" target="_blank" rel="noopener">TikTok</a>
                <a class="linkbtn" href="#" target="_blank" rel="noopener">Spotify</a>
                <a class="linkbtn" href="#" target="_blank" rel="noopener">Instagram</a>
                <a class="linkbtn" href="#" target="_blank" rel="noopener">Steam</a>
                <a class="linkbtn" href="#" target="_blank" rel="noopener">X</a>
              </div>

              <p class="mini" style="margin-top:12px">
                hub pessoal / playlists / arquivos / progresso / discord ao vivo.
                <br>vibe: internet antiga + UI dark moderna + AMV.
              </p>
            </div>

            <div class="card">
              <div class="h3">Notas</div>
              <p class="mini">
                • música: volume fixo 20% <br>
                • botão mutar/desmutar <br>
                • ao abrir janela: música pausa <br>
                • discord ao vivo (lanyard) <br>
                • tema: ESCURO / XP branco (botão TEMA ou tecla T)
              </p>
            </div>
          </div>
        </div>

        <!-- ARQUIVOS -->
        <div id="pane-archives" class="pane hidden">
          <div class="card">
            <div class="h3">Arquivos</div>
            <p class="mini">
              Área pra guardar: <br>
              • jogos (links, installs, saves) <br>
              • progresso (texto, prints, notas) <br>
              • arquivos (zip, docs, links pessoais)
            </p>
          </div>
        </div>

        <!-- PLAYLISTS -->
        <div id="pane-playlists" class="pane hidden">
          <div class="card">
            <div class="h3">Playlists</div>
            <p class="mini">
              Área pra músicas favoritas / listas / links. <br>
              (dá pra puxar do Spotify depois, ou manter manual)
            </p>
          </div>
        </div>

        <!-- ADMIN -->
        <div id="pane-admin" class="pane hidden">
          <div class="card">
            <div class="h3">Admin</div>

            <div id="adminLocked">
              <p class="mini">
                Login é só pra você ver dados internos. <br>
                Em site estático, segurança real só com backend.
                Aqui é um “gate” no front-end usando hash (não deixa a senha em texto no código).
              </p>

              <div class="form" style="margin-top:12px">
                <div class="field">
                  <label>Usuário</label>
                  <input id="user" autocomplete="username" placeholder="allz" />
                </div>
                <div class="field">
                  <label>Senha</label>
                  <input id="pass" type="password" autocomplete="current-password" placeholder="••••••••" />
                </div>
                <div style="display:flex; gap:10px; align-items:center; flex-wrap:wrap">
                  <button class="btn-bevel" id="loginBtn">ENTRAR</button>
                  <span class="mini" id="loginMsg"></span>
                </div>
              </div>

              <p class="mini" style="margin-top:12px; color:var(--muted2)">
                Pra trocar a senha, edite no JS: <b>ADMIN_USER</b> e <b>ADMIN_PASS_HASH</b>. <br>
                Pra gerar o hash, console: <code style="font-family:var(--mono);">allzHash("SUA_SENHA")</code>
              </p>
            </div>

            <div id="adminUnlocked" class="hidden">
              <p class="mini">✅ admin destravado. aqui entram seus dados internos.</p>
              <div class="card" style="margin-top:12px">
                <div class="h3">Interno</div>
                <p class="mini">
                  • painel de links internos <br>
                  • notas privadas <br>
                  • atalhos de admin
                </p>
              </div>
            </div>

          </div>
        </div>

      </div>
    </div>
  </div>

  <!-- DISCORD compacto -->
  <div class="discord-compact" id="discordCompact">
    <div class="d-ava"><img id="dAva" alt=""></div>

    <div class="d-meta">
      <div class="d-top">
        <div class="d-nick" id="dNick">—</div>
        <div class="d-user" id="dUser">—</div>
      </div>
      <div class="d-status">
        <span class="status-dot" id="dDot"></span>
        <span id="dStatus">—</span>
      </div>
    </div>

    <div class="d-mini">
      <div class="live" id="lanyardState">…</div>
      <div id="lastUpdate">—</div>
    </div>
  </div>

  <!-- áudio (troquei o link + volume 20%) -->
  <audio id="bgm" preload="auto" loop>
    <source src="https://files.catbox.moe/mkmd7z.mp3" type="audio/mpeg">
  </audio>

  <!-- beep (click) -->
  <audio id="beep" preload="auto">
    <source src="data:audio/wav;base64,UklGRlQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YVAAAAB8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fA==" type="audio/wav">
  </audio>

  <script>
    /*********************
     * CONFIG
     *********************/
    const LANYARD_USER_ID = "513830615225860096";
    const LANYARD_HTTP = `https://api.lanyard.rest/v1/users/${LANYARD_USER_ID}`;

    // Admin gate (troca)
    const ADMIN_USER = "allz";
    // SHA-256 HEX (não expõe senha em texto). Padrão atual: "allz" (troca isso!)
    const ADMIN_PASS_HASH = "a88c9e2d5e0f6d3cbb9f06e2e2c8e8f8e0c63c8b93d1f8f9df58bbdffb3c74a7";

    /*********************
     * ELEMENTOS
     *********************/
    const enter = document.getElementById("enter");
    const app = document.getElementById("app");
    const crtflash = document.getElementById("crtflash");

    const amv = document.getElementById("amv");
    const bgm = document.getElementById("bgm");
    const beep = document.getElementById("beep");

    const muteBtn = document.getElementById("muteBtn");
    const themeBtn = document.getElementById("themeBtn");
    const themeLabel = document.getElementById("themeLabel");

    const modal = document.getElementById("modal");
    const closeWin = document.getElementById("closeWin");
    const winTitle = document.getElementById("winTitle");
    const nav = document.getElementById("nav");
    const ts = document.getElementById("ts");

    let started = false;
    let muted = false;

    /*********************
     * TEMA (ESCURO / XP)
     *********************/
    function applyTheme(theme){
      document.body.setAttribute("data-theme", theme);
      themeLabel.textContent = (theme === "xp") ? "XP" : "ESCURO";
    }
    function toggleTheme(){
      const cur = document.body.getAttribute("data-theme") || "dark";
      applyTheme(cur === "xp" ? "dark" : "xp");
    }
    themeBtn.addEventListener("click", toggleTheme);
    window.addEventListener("keydown", (e)=>{
      if(e.key.toLowerCase() === "t" && started) toggleTheme();
    });

    /*********************
     * BOOT
     *********************/
    async function boot(){
      if(started) return;
      started = true;

      // flash CRT + beep
      try{
        crtflash.classList.remove("on");
        void crtflash.offsetWidth;
        crtflash.classList.add("on");
      }catch(e){}

      try{
        beep.volume = 0.12;
        beep.currentTime = 0;
        await beep.play();
      }catch(e){}

      enter.classList.add("hidden");
      app.style.display = "grid";

      // vídeo
      try{
        amv.muted = true;
        amv.autoplay = true;
        amv.playsInline = true;
        await amv.play();
      }catch(e){
        window.addEventListener("pointerdown", () => amv.play().catch(()=>{}), { once:true });
      }

      // música fixa 20% (após ENTER)
      bgm.volume = 0.20;
      try { await bgm.play(); }
      catch(e){
        window.addEventListener("pointerdown", () => bgm.play().catch(()=>{}), { once:true });
      }

      startLanyard();
      startParticles();
      setInterval(updateTimestamp, 250);
    }

    enter.addEventListener("click", boot);
    window.addEventListener("keydown", (e)=>{
      if(e.key === "Enter") boot();
    });

    /*********************
     * TIMESTAMP
     *********************/
    function pad2(n){ return String(n).padStart(2,"0"); }
    function updateTimestamp(){
      const t = Math.floor(amv.currentTime || 0);
      const h = Math.floor(t/3600);
      const m = Math.floor((t%3600)/60);
      const s = t%60;
      ts.textContent = `${pad2(h)}:${pad2(m)}:${pad2(s)}`;
    }

    /*********************
     * MUTE
     *********************/
    muteBtn.addEventListener("click", ()=>{
      muted = !muted;
      if(muted){
        bgm.pause();
        muteBtn.textContent = "DESMUTAR";
      }else{
        bgm.volume = 0.20;
        bgm.play().catch(()=>{});
        muteBtn.textContent = "MUTAR";
      }
    });

    /*********************
     * MODAL (JANELAS) + CLICK SOUND
     *********************/
    const panes = {
      social: document.getElementById("pane-social"),
      archives: document.getElementById("pane-archives"),
      playlists: document.getElementById("pane-playlists"),
      admin: document.getElementById("pane-admin"),
    };

    const titles = {
      social: "SOCIAL",
      archives: "ARQUIVOS",
      playlists: "PLAYLISTS",
      admin: "ADMIN",
    };

    function setActiveBtn(view){
      [...nav.querySelectorAll("button[data-view]")].forEach(b=>{
        b.classList.toggle("active", b.dataset.view === view);
      });
    }

    async function uiClick(){
      try{
        beep.volume = 0.10;
        beep.currentTime = 0;
        await beep.play();
      }catch(e){}
    }

    function openWindow(view){
      uiClick();

      // pausa música ao abrir janela
      bgm.pause();

      setActiveBtn(view);

      Object.values(panes).forEach(p=>p.classList.add("hidden"));
      if(panes[view]) panes[view].classList.remove("hidden");

      winTitle.textContent = titles[view] || view.toUpperCase();
      modal.classList.add("open");
    }

    function closeWindowFn(){
      uiClick();

      modal.classList.remove("open");
      setTimeout(()=>{
        if(!muted) bgm.play().catch(()=>{});
      }, 220);
    }

    nav.addEventListener("click", (e)=>{
      const btn = e.target.closest("button[data-view]");
      if(!btn) return;
      openWindow(btn.dataset.view);
    });

    closeWin.addEventListener("click", closeWindowFn);
    modal.addEventListener("click", (e)=>{
      if(e.target === modal) closeWindowFn();
    });
    window.addEventListener("keydown", (e)=>{
      if(e.key === "Escape" && modal.classList.contains("open")) closeWindowFn();
    });

    /*********************
     * DISCORD (LANYARD) - compacto + última atualização
     *********************/
    const dAva = document.getElementById("dAva");
    const dNick = document.getElementById("dNick");
    const dUser = document.getElementById("dUser");
    const dStatus = document.getElementById("dStatus");
    const dDot = document.getElementById("dDot");
    const lanyardState = document.getElementById("lanyardState");
    const lastUpdate = document.getElementById("lastUpdate");

    let ws;
    let pollTimer;
    let lastUpdateTs = null;

    function getCss(varName){
      return getComputedStyle(document.documentElement).getPropertyValue(varName).trim();
    }
    function statusColor(s){
      if(s === "online") return getCss("--good");
      if(s === "idle") return getCss("--idle");
      if(s === "dnd") return getCss("--dnd");
      return getCss("--offline");
    }
    function statusPtBr(s){
      const map = { online:"online", idle:"ausente", dnd:"não perturbe", offline:"offline" };
      return map[s] || "offline";
    }

    function setLastUpdateNow(){
      lastUpdateTs = new Date();
      const hh = String(lastUpdateTs.getHours()).padStart(2,"0");
      const mm = String(lastUpdateTs.getMinutes()).padStart(2,"0");
      lastUpdate.textContent = `${hh}:${mm}`;
    }

    function applyLanyard(payload){
      const data = payload?.data || payload;
      if(!data) return;

      const u = data.discord_user || {};
      const globalName = u.global_name || u.username || "—";
      const username = u.username ? `@${u.username}` : "—";
      const avatarHash = u.avatar;

      const avatarUrl = (avatarHash)
        ? `https://cdn.discordapp.com/avatars/${LANYARD_USER_ID}/${avatarHash}.png?size=128`
        : `https://cdn.discordapp.com/embed/avatars/0.png`;

      dAva.src = avatarUrl;
      dNick.textContent = globalName;
      dUser.textContent = username;

      const st = data.discord_status || "offline";
      const stBr = statusPtBr(st);
      dStatus.textContent = stBr;

      const c = statusColor(st);
      dDot.style.background = c;
      dDot.style.boxShadow = `0 0 12px ${c}55`;

      setLastUpdateNow();
    }

    async function pollLanyard(){
      try{
        lanyardState.textContent = "atualizando";
        const res = await fetch(LANYARD_HTTP, { cache:"no-store" });
        const json = await res.json();
        applyLanyard(json);
        lanyardState.textContent = "online";
      }catch(e){
        lanyardState.textContent = "offline";
        if(!lastUpdateTs) lastUpdate.textContent = "—";
      }
    }

    function startLanyard(){
      try{
        lanyardState.textContent = "conectando";
        ws = new WebSocket("wss://api.lanyard.rest/socket");

        ws.onmessage = (ev)=>{
          const msg = JSON.parse(ev.data);

          if(msg.op === 1){
            ws.send(JSON.stringify({ op: 2, d: { subscribe_to_id: LANYARD_USER_ID } }));
            const interval = msg.d.heartbeat_interval;
            setInterval(()=>{
              try{ ws.send(JSON.stringify({ op: 3, d: {} })); }catch(e){}
            }, interval);
          }

          if(msg.t === "INIT_STATE" || msg.t === "PRESENCE_UPDATE"){
            applyLanyard(msg.d);
            lanyardState.textContent = "online";
          }
        };

        ws.onerror = () => {
          if(!pollTimer){
            pollLanyard();
            pollTimer = setInterval(pollLanyard, 15000);
          }
        };
        ws.onclose = () => {
          if(!pollTimer){
            pollLanyard();
            pollTimer = setInterval(pollLanyard, 15000);
          }
        };
      }catch(e){
        pollLanyard();
        pollTimer = setInterval(pollLanyard, 15000);
      }
    }

    /*********************
     * ADMIN LOGIN (hash) — mantive como tava
     *********************/
    const loginBtn = document.getElementById("loginBtn");
    const loginMsg = document.getElementById("loginMsg");
    const adminLocked = document.getElementById("adminLocked");
    const adminUnlocked = document.getElementById("adminUnlocked");

    loginBtn.addEventListener("click", async ()=>{
      loginMsg.textContent = "…";
      const u = document.getElementById("user").value.trim();
      const p = document.getElementById("pass").value;

      if(!u || !p){ loginMsg.textContent = "preencha."; return; }

      const hash = await sha256Hex(p);

      if(u.toLowerCase() === ADMIN_USER.toLowerCase() && hash === ADMIN_PASS_HASH){
        loginMsg.textContent = "ok.";
        adminLocked.classList.add("hidden");
        adminUnlocked.classList.remove("hidden");
      }else{
        loginMsg.textContent = "negado.";
      }
    });

    async function sha256Hex(text){
      const enc = new TextEncoder().encode(text);
      const buf = await crypto.subtle.digest("SHA-256", enc);
      return [...new Uint8Array(buf)].map(b=>b.toString(16).padStart(2,"0")).join("");
    }
    window.allzHash = async (txt)=>{
      const h = await sha256Hex(txt);
      console.log(h);
      return h;
    };

    /*********************
     * PARTICLES (laranja leve)
     *********************/
    function startParticles(){
      const canvas = document.getElementById("particles");
      const ctx = canvas.getContext("2d", { alpha:true });

      const DPR = Math.min(2, window.devicePixelRatio || 1);
      let W, H;

      function resize(){
        W = canvas.width = Math.floor(window.innerWidth * DPR);
        H = canvas.height = Math.floor(window.innerHeight * DPR);
        canvas.style.width = window.innerWidth + "px";
        canvas.style.height = window.innerHeight + "px";
      }
      window.addEventListener("resize", resize);
      resize();

      const count = Math.floor(Math.min(110, Math.max(55, (window.innerWidth * window.innerHeight) / 20000)));
      const particles = Array.from({length: count}, ()=>spawn());

      function spawn(){
        return {
          x: Math.random()*W,
          y: Math.random()*H,
          r: (Math.random()*1.5 + 0.5) * DPR,
          a: Math.random()*0.18 + 0.05,
          vx: (Math.random()*0.16 - 0.08) * DPR,
          vy: (Math.random()*0.20 + 0.04) * DPR,
          tw: Math.random()*0.8 + 0.2,
        };
      }

      let t = 0;
      function tick(){
        t += 0.016;
        ctx.clearRect(0,0,W,H);
        ctx.globalCompositeOperation = "lighter";

        const isXp = (document.body.getAttribute("data-theme") === "xp");

        for(let i=0;i<particles.length;i++){
          const p = particles[i];
          p.x += p.vx * (0.7 + Math.sin(t*p.tw)*0.25);
          p.y -= p.vy * (0.7 + Math.cos(t*p.tw)*0.25);

          if(p.y < -20*DPR || p.x < -40*DPR || p.x > W + 40*DPR){
            particles[i] = spawn();
            particles[i].y = H + (Math.random()*120*DPR);
          }

          if(!isXp){
            const alpha = p.a * (0.75 + 0.25*Math.sin(t*p.tw));
            ctx.fillStyle = `rgba(255, 140, 50, ${alpha})`;
            ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); ctx.fill();

            ctx.fillStyle = `rgba(255, 140, 50, ${alpha*0.22})`;
            ctx.beginPath(); ctx.arc(p.x, p.y, p.r*3.0, 0, Math.PI*2); ctx.fill();
          }else{
            // XP: partícula “poeirinha” cinza bem leve
            const alpha = (p.a * 0.55) * (0.75 + 0.25*Math.sin(t*p.tw));
            ctx.fillStyle = `rgba(0, 0, 0, ${alpha})`;
            ctx.beginPath(); ctx.arc(p.x, p.y, p.r, 0, Math.PI*2); ctx.fill();

            ctx.fillStyle = `rgba(0, 0, 0, ${alpha*0.18})`;
            ctx.beginPath(); ctx.arc(p.x, p.y, p.r*3.0, 0, Math.PI*2); ctx.fill();
          }
        }

        ctx.globalCompositeOperation = "source-over";
        requestAnimationFrame(tick);
      }
      tick();
    }

    /*********************
     * VISIBILITY: pausa/retoma
     *********************/
    document.addEventListener("visibilitychange", ()=>{
      if(!started) return;
      if(document.visibilityState === "visible"){
        amv.play().catch(()=>{});
        if(!muted) bgm.play().catch(()=>{});
      }else{
        bgm.pause();
      }
    });
  </script>
</body>
</html>
